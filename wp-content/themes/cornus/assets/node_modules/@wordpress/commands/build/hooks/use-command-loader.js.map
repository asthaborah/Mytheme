{"version":3,"names":["_element","require","_data","_store","useCommandLoader","loader","registerCommandLoader","unregisterCommandLoader","useDispatch","commandsStore","useEffect","disabled","name","hook","context"],"sources":["@wordpress/commands/src/hooks/use-command-loader.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useEffect } from '@wordpress/element';\nimport { useDispatch } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport { store as commandsStore } from '../store';\n\n/**\n * Attach a command loader to the command palette. Used for dynamic commands.\n *\n * @param {import('../store/actions').WPCommandLoaderConfig} loader command loader config.\n *\n * @example\n * ```js\n * import { useCommandLoader } from '@wordpress/commands';\n * import { post, page, layout, symbolFilled } from '@wordpress/icons';\n *\n * const icons = {\n *     post,\n *     page,\n *     wp_template: layout,\n *     wp_template_part: symbolFilled,\n * };\n *\n * function usePageSearchCommandLoader( { search } ) {\n *     // Retrieve the pages for the \"search\" term.\n *     const { records, isLoading } = useSelect( ( select ) => {\n *         const { getEntityRecords } = select( coreStore );\n *         const query = {\n *             search: !! search ? search : undefined,\n *             per_page: 10,\n *             orderby: search ? 'relevance' : 'date',\n *         };\n *         return {\n *             records: getEntityRecords( 'postType', 'page', query ),\n *             isLoading: ! select( coreStore ).hasFinishedResolution(\n *                 'getEntityRecords',\n *                 'postType', 'page', query ]\n *             ),\n *         };\n *     }, [ search ] );\n *\n *     // Create the commands.\n *     const commands = useMemo( () => {\n *         return ( records ?? [] ).slice( 0, 10 ).map( ( record ) => {\n *             return {\n *                 name: record.title?.rendered + ' ' + record.id,\n *                 label: record.title?.rendered\n *                     ? record.title?.rendered\n *                     : __( '(no title)' ),\n *                 icon: icons[ postType ],\n *                 callback: ( { close } ) => {\n *                     const args = {\n *                         postType,\n *                         postId: record.id,\n *                         ...extraArgs,\n *                     };\n *                     document.location = addQueryArgs( 'site-editor.php', args );\n *                     close();\n *                 },\n *             };\n *         } );\n *     }, [ records, history ] );\n *\n *     return {\n *         commands,\n *         isLoading,\n *     };\n * }\n *\n * useCommandLoader( {\n *     name: 'myplugin/page-search',\n *     hook: usePageSearchCommandLoader,\n * } );\n * ```\n */\nexport default function useCommandLoader( loader ) {\n\tconst { registerCommandLoader, unregisterCommandLoader } =\n\t\tuseDispatch( commandsStore );\n\tuseEffect( () => {\n\t\tif ( loader.disabled ) {\n\t\t\treturn;\n\t\t}\n\t\tregisterCommandLoader( {\n\t\t\tname: loader.name,\n\t\t\thook: loader.hook,\n\t\t\tcontext: loader.context,\n\t\t} );\n\t\treturn () => {\n\t\t\tunregisterCommandLoader( loader.name );\n\t\t};\n\t}, [\n\t\tloader.name,\n\t\tloader.hook,\n\t\tloader.context,\n\t\tloader.disabled,\n\t\tregisterCommandLoader,\n\t\tunregisterCommandLoader,\n\t] );\n}\n"],"mappings":";;;;;;AAGA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,KAAA,GAAAD,OAAA;AAKA,IAAAE,MAAA,GAAAF,OAAA;AATA;AACA;AACA;;AAIA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,SAASG,gBAAgBA,CAAEC,MAAM,EAAG;EAClD,MAAM;IAAEC,qBAAqB;IAAEC;EAAwB,CAAC,GACvD,IAAAC,iBAAW,EAAEC,YAAc,CAAC;EAC7B,IAAAC,kBAAS,EAAE,MAAM;IAChB,IAAKL,MAAM,CAACM,QAAQ,EAAG;MACtB;IACD;IACAL,qBAAqB,CAAE;MACtBM,IAAI,EAAEP,MAAM,CAACO,IAAI;MACjBC,IAAI,EAAER,MAAM,CAACQ,IAAI;MACjBC,OAAO,EAAET,MAAM,CAACS;IACjB,CAAE,CAAC;IACH,OAAO,MAAM;MACZP,uBAAuB,CAAEF,MAAM,CAACO,IAAK,CAAC;IACvC,CAAC;EACF,CAAC,EAAE,CACFP,MAAM,CAACO,IAAI,EACXP,MAAM,CAACQ,IAAI,EACXR,MAAM,CAACS,OAAO,EACdT,MAAM,CAACM,QAAQ,EACfL,qBAAqB,EACrBC,uBAAuB,CACtB,CAAC;AACJ"}