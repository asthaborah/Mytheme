{"version":3,"names":["_reactNative","require","_element","_data","_blocks","_components","_searchResults","_interopRequireDefault","_store","_tabs","_style","_utils","MIN_ITEMS_FOR_SEARCH","InserterMenu","onSelect","onDismiss","rootClientId","clientId","isAppender","shouldReplaceBlock","insertionIndex","filterValue","setFilterValue","useState","showTabs","setShowTabs","tabIndex","setTabIndex","isIOS","Platform","OS","showInsertionPoint","hideInsertionPoint","clearSelectedBlock","insertBlock","removeBlock","resetBlocks","insertDefaultBlock","useDispatch","blockEditorStore","items","destinationRootClientId","showReusableBlocks","useSelect","select","getInserterItems","getBlockRootClientId","getBlockSelectionEnd","targetRootClientId","end","undefined","allItems","reusableBlockItems","filterInserterItems","onlyReusable","length","getBlockOrder","getBlockCount","useEffect","count","blockToReplace","onClose","useCallback","onInsert","item","name","initialAttributes","innerBlocks","newBlock","createBlock","source","onSelectItem","AccessibilityInfo","isScreenReaderEnabled","then","enabled","timeout","setTimeout","onChangeSearch","value","onKeyboardShow","onKeyboardHide","showSearchForm","isFullScreen","_react","createElement","BottomSheet","isVisible","header","Fragment","SearchControl","onChange","default","Control","onChangeTab","hasNavigation","setMinHeightToMaxHeight","contentStyle","styles","allowDragIndicator","BottomSheetConsumer","listProps","TouchableHighlight","accessible","style","_default","exports"],"sources":["@wordpress/block-editor/src/components/inserter/menu.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { AccessibilityInfo, TouchableHighlight, Platform } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { useEffect, useState, useCallback } from '@wordpress/element';\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { createBlock } from '@wordpress/blocks';\nimport {\n\tBottomSheet,\n\tBottomSheetConsumer,\n\tSearchControl,\n} from '@wordpress/components';\n\n/**\n * Internal dependencies\n */\nimport InserterSearchResults from './search-results';\nimport { store as blockEditorStore } from '../../store';\nimport InserterTabs from './tabs';\nimport styles from './style.scss';\nimport { filterInserterItems } from './utils';\n\nconst MIN_ITEMS_FOR_SEARCH = 2;\nfunction InserterMenu( {\n\tonSelect,\n\tonDismiss,\n\trootClientId,\n\tclientId,\n\tisAppender,\n\tshouldReplaceBlock,\n\tinsertionIndex,\n} ) {\n\tconst [ filterValue, setFilterValue ] = useState( '' );\n\tconst [ showTabs, setShowTabs ] = useState( true );\n\tconst [ tabIndex, setTabIndex ] = useState( 0 );\n\n\tconst isIOS = Platform.OS === 'ios';\n\n\tconst {\n\t\tshowInsertionPoint,\n\t\thideInsertionPoint,\n\t\tclearSelectedBlock,\n\t\tinsertBlock,\n\t\tremoveBlock,\n\t\tresetBlocks,\n\t\tinsertDefaultBlock,\n\t} = useDispatch( blockEditorStore );\n\n\tconst { items, destinationRootClientId, showReusableBlocks } = useSelect(\n\t\t( select ) => {\n\t\t\tconst {\n\t\t\t\tgetInserterItems,\n\t\t\t\tgetBlockRootClientId,\n\t\t\t\tgetBlockSelectionEnd,\n\t\t\t} = select( blockEditorStore );\n\n\t\t\tlet targetRootClientId = rootClientId;\n\t\t\tif ( ! targetRootClientId && ! clientId && ! isAppender ) {\n\t\t\t\tconst end = getBlockSelectionEnd();\n\t\t\t\tif ( end ) {\n\t\t\t\t\ttargetRootClientId =\n\t\t\t\t\t\tgetBlockRootClientId( end ) || undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst allItems = getInserterItems( targetRootClientId );\n\t\t\tconst reusableBlockItems = filterInserterItems( allItems, {\n\t\t\t\tonlyReusable: true,\n\t\t\t} );\n\n\t\t\treturn {\n\t\t\t\titems: allItems,\n\t\t\t\tdestinationRootClientId: targetRootClientId,\n\t\t\t\tshowReusableBlocks: !! reusableBlockItems.length,\n\t\t\t};\n\t\t}\n\t);\n\n\tconst { getBlockOrder, getBlockCount } = useSelect( blockEditorStore );\n\n\tuseEffect( () => {\n\t\t// Show/Hide insertion point on Mount/Dismount\n\t\tif ( shouldReplaceBlock ) {\n\t\t\tconst count = getBlockCount();\n\t\t\t// Check if there is a rootClientId because that means it is a nested replaceable block\n\t\t\t// and we don't want to clear/reset all blocks.\n\t\t\tif ( count === 1 && ! rootClientId ) {\n\t\t\t\t// Removing the last block is not possilble with `removeBlock` action.\n\t\t\t\t// It always inserts a default block if the last of the blocks have been removed.\n\t\t\t\tclearSelectedBlock();\n\t\t\t\tresetBlocks( [] );\n\t\t\t} else {\n\t\t\t\tconst blockToReplace = getBlockOrder( destinationRootClientId )[\n\t\t\t\t\tinsertionIndex\n\t\t\t\t];\n\t\t\t\tremoveBlock( blockToReplace, false );\n\t\t\t}\n\t\t}\n\t\tshowInsertionPoint( destinationRootClientId, insertionIndex );\n\n\t\treturn hideInsertionPoint;\n\t}, [] );\n\n\tconst onClose = useCallback( () => {\n\t\t// If should replace but didn't insert any block\n\t\t// re-insert default block.\n\t\tif ( shouldReplaceBlock ) {\n\t\t\tinsertDefaultBlock( {}, destinationRootClientId, insertionIndex );\n\t\t}\n\t\tonDismiss();\n\t}, [ shouldReplaceBlock, destinationRootClientId, insertionIndex ] );\n\n\tconst onInsert = useCallback(\n\t\t( item ) => {\n\t\t\tconst { name, initialAttributes, innerBlocks } = item;\n\n\t\t\tconst newBlock = createBlock(\n\t\t\t\tname,\n\t\t\t\tinitialAttributes,\n\t\t\t\tinnerBlocks\n\t\t\t);\n\n\t\t\tinsertBlock(\n\t\t\t\tnewBlock,\n\t\t\t\tinsertionIndex,\n\t\t\t\tdestinationRootClientId,\n\t\t\t\ttrue,\n\t\t\t\t{ source: 'inserter_menu' }\n\t\t\t);\n\t\t},\n\t\t[ insertBlock, destinationRootClientId, insertionIndex ]\n\t);\n\n\tconst onSelectItem = useCallback(\n\t\t( item ) => {\n\t\t\t// Avoid a focus loop, see https://github.com/WordPress/gutenberg/issues/30562\n\t\t\tif ( Platform.OS === 'ios' ) {\n\t\t\t\tAccessibilityInfo.isScreenReaderEnabled().then( ( enabled ) => {\n\t\t\t\t\t// In testing, the bug focus loop needed a longer timeout when VoiceOver was enabled.\n\t\t\t\t\tconst timeout = enabled ? 200 : 100;\n\t\t\t\t\t// eslint-disable-next-line @wordpress/react-no-unsafe-timeout\n\t\t\t\t\tsetTimeout( () => {\n\t\t\t\t\t\tonInsert( item );\n\t\t\t\t\t}, timeout );\n\t\t\t\t} );\n\t\t\t} else {\n\t\t\t\tonInsert( item );\n\t\t\t}\n\t\t\tonSelect( item );\n\t\t},\n\t\t[ onInsert, onSelect ]\n\t);\n\n\tconst onChangeSearch = useCallback(\n\t\t( value ) => {\n\t\t\tsetFilterValue( value );\n\t\t},\n\t\t[ setFilterValue ]\n\t);\n\n\tconst onKeyboardShow = useCallback(\n\t\t() => setShowTabs( false ),\n\t\t[ setShowTabs ]\n\t);\n\n\tconst onKeyboardHide = useCallback(\n\t\t() => setShowTabs( true ),\n\t\t[ setShowTabs ]\n\t);\n\n\tconst showSearchForm = items.length > MIN_ITEMS_FOR_SEARCH;\n\tconst isFullScreen = ! isIOS && showSearchForm;\n\n\treturn (\n\t\t<BottomSheet\n\t\t\tisVisible\n\t\t\tonClose={ onClose }\n\t\t\tonKeyboardShow={ onKeyboardShow }\n\t\t\tonKeyboardHide={ onKeyboardHide }\n\t\t\theader={\n\t\t\t\t<>\n\t\t\t\t\t{ showSearchForm && (\n\t\t\t\t\t\t<SearchControl\n\t\t\t\t\t\t\tonChange={ onChangeSearch }\n\t\t\t\t\t\t\tvalue={ filterValue }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t\t{ showTabs && ! filterValue && (\n\t\t\t\t\t\t<InserterTabs.Control\n\t\t\t\t\t\t\tonChangeTab={ setTabIndex }\n\t\t\t\t\t\t\tshowReusableBlocks={ showReusableBlocks }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</>\n\t\t\t}\n\t\t\thasNavigation\n\t\t\tsetMinHeightToMaxHeight\n\t\t\tcontentStyle={ styles[ 'inserter-menu__list' ] }\n\t\t\tisFullScreen={ isFullScreen }\n\t\t\tallowDragIndicator\n\t\t>\n\t\t\t<BottomSheetConsumer>\n\t\t\t\t{ ( { listProps } ) => (\n\t\t\t\t\t<TouchableHighlight\n\t\t\t\t\t\taccessible={ false }\n\t\t\t\t\t\tstyle={ styles[ 'inserter-menu__list-wrapper' ] }\n\t\t\t\t\t>\n\t\t\t\t\t\t{ ! showTabs || filterValue ? (\n\t\t\t\t\t\t\t<InserterSearchResults\n\t\t\t\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\t\t\t\tfilterValue={ filterValue }\n\t\t\t\t\t\t\t\tonSelect={ onSelectItem }\n\t\t\t\t\t\t\t\tlistProps={ listProps }\n\t\t\t\t\t\t\t\tisFullScreen={ isFullScreen }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<InserterTabs\n\t\t\t\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\t\t\t\tlistProps={ listProps }\n\t\t\t\t\t\t\t\ttabIndex={ tabIndex }\n\t\t\t\t\t\t\t\tonSelect={ onSelectItem }\n\t\t\t\t\t\t\t\tshowReusableBlocks={ showReusableBlocks }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t) }\n\t\t\t\t\t</TouchableHighlight>\n\t\t\t\t) }\n\t\t\t</BottomSheetConsumer>\n\t\t</BottomSheet>\n\t);\n}\n\nexport default InserterMenu;\n"],"mappings":"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"}