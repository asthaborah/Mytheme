{"version":3,"names":["createContext","useContext","orderBy","DEFAULT_BLOCK_LIST_CONTEXT","scrollRef","blocksLayouts","current","findBlockLayoutByClientId","getBlockLayoutsOrderedByYCoord","findBlockLayoutByPosition","updateBlocksLayouts","Context","Provider","Consumer","data","position","Object","values","find","block","x","width","y","height","clientId","entries","reduce","acc","entry","item","innerBlocks","keys","length","deleteBlockLayoutByClientId","key","blockData","rootClientId","shouldRemove","layoutProps","BlockListProvider","BlockListConsumer","useBlockListContext"],"sources":["@wordpress/block-editor/src/components/block-list/block-list-context.native.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { createContext, useContext } from '@wordpress/element';\n\n/**\n * Internal dependencies\n */\nimport { orderBy } from '../../utils/sorting';\n\nexport const DEFAULT_BLOCK_LIST_CONTEXT = {\n\tscrollRef: null,\n\tblocksLayouts: { current: {} },\n\tfindBlockLayoutByClientId,\n\tgetBlockLayoutsOrderedByYCoord,\n\tfindBlockLayoutByPosition,\n\tupdateBlocksLayouts,\n};\n\nconst Context = createContext( DEFAULT_BLOCK_LIST_CONTEXT );\nconst { Provider, Consumer } = Context;\n\n/**\n * Finds a block's layout data by position.\n *\n * @param {Object} data       Blocks layouts object.\n * @param {Object} position   Position to use for finding the block.\n * @param {number} position.x X coordinate.\n * @param {number} position.y Y coordinate.\n *\n * @return {Object|undefined} Found block layout data that matches the provided position. If none is found, `undefined` will be returned.\n */\nfunction findBlockLayoutByPosition( data, position ) {\n\t// Only enabled for root level blocks\n\treturn Object.values( data ).find( ( block ) => {\n\t\treturn (\n\t\t\tposition.x >= block.x &&\n\t\t\tposition.x <= block.x + block.width &&\n\t\t\tposition.y >= block.y &&\n\t\t\tposition.y <= block.y + block.height\n\t\t);\n\t} );\n}\n\n/**\n * Finds a block's layout data by its client Id.\n *\n * @param {Object} data     Blocks layouts object.\n * @param {string} clientId Block's clientId.\n *\n * @return {Object} Found block layout data.\n */\nfunction findBlockLayoutByClientId( data, clientId ) {\n\treturn Object.entries( data ).reduce( ( acc, entry ) => {\n\t\tconst item = entry[ 1 ];\n\t\tif ( acc ) {\n\t\t\treturn acc;\n\t\t}\n\t\tif ( item?.clientId === clientId ) {\n\t\t\treturn item;\n\t\t}\n\t\tif ( item?.innerBlocks && Object.keys( item.innerBlocks ).length > 0 ) {\n\t\t\treturn findBlockLayoutByClientId( item.innerBlocks, clientId );\n\t\t}\n\t\treturn null;\n\t}, null );\n}\n\n/**\n * Deletes the layout data of a block by its client Id.\n *\n * @param {Object} data     Blocks layouts object.\n * @param {string} clientId Block's clientsId.\n *\n * @return {Object} Updated data object.\n */\nexport function deleteBlockLayoutByClientId( data, clientId ) {\n\treturn Object.keys( data ).reduce( ( acc, key ) => {\n\t\tif ( key !== clientId ) {\n\t\t\tacc[ key ] = data[ key ];\n\t\t}\n\t\tif (\n\t\t\tdata[ key ]?.innerBlocks &&\n\t\t\tObject.keys( data[ key ].innerBlocks ).length > 0\n\t\t) {\n\t\t\tif ( acc[ key ] ) {\n\t\t\t\tacc[ key ].innerBlocks = deleteBlockLayoutByClientId(\n\t\t\t\t\tdata[ key ].innerBlocks,\n\t\t\t\t\tclientId\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn acc;\n\t}, {} );\n}\n\n/**\n * Orders the block's layout data by its Y coordinate.\n *\n * @param {Object} data Blocks layouts object.\n *\n * @return {Object} Blocks layouts object ordered by its Y coordinate.\n */\nfunction getBlockLayoutsOrderedByYCoord( data ) {\n\t// Only enabled for root level blocks.\n\treturn orderBy( Object.values( data ), 'y' );\n}\n\n/**\n * Updates or deletes a block's layout data in the blocksLayouts object,\n * in case of deletion, the layout data is not required.\n *\n * @param {Object}   blocksLayouts          Blocks layouts object.\n * @param {Object}   blockData              Block's layout data to add or remove to/from the blockLayouts object.\n * @param {string}   blockData.clientId     Block's clientId.\n * @param {?string}  blockData.rootClientId Optional. Block's rootClientId.\n * @param {?boolean} blockData.shouldRemove Optional. Flag to remove it from the blocksLayout list.\n * @param {number}   blockData.width        Block's width.\n * @param {number}   blockData.height       Block's height.\n * @param {number}   blockData.x            Block's x coordinate (relative to the parent).\n * @param {number}   blockData.y            Block's y coordinate (relative to the parent).\n */\n\nfunction updateBlocksLayouts( blocksLayouts, blockData ) {\n\tconst { clientId, rootClientId, shouldRemove, ...layoutProps } = blockData;\n\n\tif ( clientId && shouldRemove ) {\n\t\tblocksLayouts.current = deleteBlockLayoutByClientId(\n\t\t\tblocksLayouts.current,\n\t\t\tclientId\n\t\t);\n\t\treturn;\n\t}\n\n\tif ( clientId && ! rootClientId ) {\n\t\tblocksLayouts.current[ clientId ] = {\n\t\t\tclientId,\n\t\t\trootClientId,\n\t\t\t...layoutProps,\n\t\t\tinnerBlocks: {\n\t\t\t\t...blocksLayouts.current[ clientId ]?.innerBlocks,\n\t\t\t},\n\t\t};\n\t} else if ( clientId && rootClientId ) {\n\t\tconst block = findBlockLayoutByClientId(\n\t\t\tblocksLayouts.current,\n\t\t\trootClientId\n\t\t);\n\n\t\tif ( block ) {\n\t\t\tblock.innerBlocks[ clientId ] = {\n\t\t\t\tclientId,\n\t\t\t\trootClientId,\n\t\t\t\t...layoutProps,\n\t\t\t\tinnerBlocks: {\n\t\t\t\t\t...block.innerBlocks[ clientId ]?.innerBlocks,\n\t\t\t\t},\n\t\t\t};\n\t\t}\n\t}\n}\n\nexport { Provider as BlockListProvider, Consumer as BlockListConsumer };\n\n/**\n * Hook that returns the block list context.\n *\n * @return {Object} Block list context\n */\nexport const useBlockListContext = () => {\n\treturn useContext( Context );\n};\n"],"mappings":"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"}