{"version":3,"names":["isEmpty","isPhrasingContent","normaliseBlocks","HTML","decuDoc","document","implementation","createHTMLDocument","accuDoc","decu","body","accu","innerHTML","firstChild","node","nodeType","TEXT_NODE","removeChild","lastChild","nodeName","appendChild","createElement","ELEMENT_NODE","nextSibling","hasChildNodes"],"sources":["@wordpress/blocks/src/api/raw-handling/normalise-blocks.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { isEmpty, isPhrasingContent } from '@wordpress/dom';\n\nexport default function normaliseBlocks( HTML ) {\n\tconst decuDoc = document.implementation.createHTMLDocument( '' );\n\tconst accuDoc = document.implementation.createHTMLDocument( '' );\n\n\tconst decu = decuDoc.body;\n\tconst accu = accuDoc.body;\n\n\tdecu.innerHTML = HTML;\n\n\twhile ( decu.firstChild ) {\n\t\tconst node = decu.firstChild;\n\n\t\t// Text nodes: wrap in a paragraph, or append to previous.\n\t\tif ( node.nodeType === node.TEXT_NODE ) {\n\t\t\tif ( isEmpty( node ) ) {\n\t\t\t\tdecu.removeChild( node );\n\t\t\t} else {\n\t\t\t\tif ( ! accu.lastChild || accu.lastChild.nodeName !== 'P' ) {\n\t\t\t\t\taccu.appendChild( accuDoc.createElement( 'P' ) );\n\t\t\t\t}\n\n\t\t\t\taccu.lastChild.appendChild( node );\n\t\t\t}\n\t\t\t// Element nodes.\n\t\t} else if ( node.nodeType === node.ELEMENT_NODE ) {\n\t\t\t// BR nodes: create a new paragraph on double, or append to previous.\n\t\t\tif ( node.nodeName === 'BR' ) {\n\t\t\t\tif ( node.nextSibling && node.nextSibling.nodeName === 'BR' ) {\n\t\t\t\t\taccu.appendChild( accuDoc.createElement( 'P' ) );\n\t\t\t\t\tdecu.removeChild( node.nextSibling );\n\t\t\t\t}\n\n\t\t\t\t// Don't append to an empty paragraph.\n\t\t\t\tif (\n\t\t\t\t\taccu.lastChild &&\n\t\t\t\t\taccu.lastChild.nodeName === 'P' &&\n\t\t\t\t\taccu.lastChild.hasChildNodes()\n\t\t\t\t) {\n\t\t\t\t\taccu.lastChild.appendChild( node );\n\t\t\t\t} else {\n\t\t\t\t\tdecu.removeChild( node );\n\t\t\t\t}\n\t\t\t} else if ( node.nodeName === 'P' ) {\n\t\t\t\t// Only append non-empty paragraph nodes.\n\t\t\t\tif ( isEmpty( node ) ) {\n\t\t\t\t\tdecu.removeChild( node );\n\t\t\t\t} else {\n\t\t\t\t\taccu.appendChild( node );\n\t\t\t\t}\n\t\t\t} else if ( isPhrasingContent( node ) ) {\n\t\t\t\tif ( ! accu.lastChild || accu.lastChild.nodeName !== 'P' ) {\n\t\t\t\t\taccu.appendChild( accuDoc.createElement( 'P' ) );\n\t\t\t\t}\n\t\t\t\taccu.lastChild.appendChild( node );\n\t\t\t} else {\n\t\t\t\taccu.appendChild( node );\n\t\t\t}\n\t\t} else {\n\t\t\tdecu.removeChild( node );\n\t\t}\n\t}\n\n\treturn accu.innerHTML;\n}\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,OAAO,EAAEC,iBAAiB,QAAQ,gBAAgB;AAE3D,eAAe,SAASC,eAAeA,CAAEC,IAAI,EAAG;EAC/C,MAAMC,OAAO,GAAGC,QAAQ,CAACC,cAAc,CAACC,kBAAkB,CAAE,EAAG,CAAC;EAChE,MAAMC,OAAO,GAAGH,QAAQ,CAACC,cAAc,CAACC,kBAAkB,CAAE,EAAG,CAAC;EAEhE,MAAME,IAAI,GAAGL,OAAO,CAACM,IAAI;EACzB,MAAMC,IAAI,GAAGH,OAAO,CAACE,IAAI;EAEzBD,IAAI,CAACG,SAAS,GAAGT,IAAI;EAErB,OAAQM,IAAI,CAACI,UAAU,EAAG;IACzB,MAAMC,IAAI,GAAGL,IAAI,CAACI,UAAU;;IAE5B;IACA,IAAKC,IAAI,CAACC,QAAQ,KAAKD,IAAI,CAACE,SAAS,EAAG;MACvC,IAAKhB,OAAO,CAAEc,IAAK,CAAC,EAAG;QACtBL,IAAI,CAACQ,WAAW,CAAEH,IAAK,CAAC;MACzB,CAAC,MAAM;QACN,IAAK,CAAEH,IAAI,CAACO,SAAS,IAAIP,IAAI,CAACO,SAAS,CAACC,QAAQ,KAAK,GAAG,EAAG;UAC1DR,IAAI,CAACS,WAAW,CAAEZ,OAAO,CAACa,aAAa,CAAE,GAAI,CAAE,CAAC;QACjD;QAEAV,IAAI,CAACO,SAAS,CAACE,WAAW,CAAEN,IAAK,CAAC;MACnC;MACA;IACD,CAAC,MAAM,IAAKA,IAAI,CAACC,QAAQ,KAAKD,IAAI,CAACQ,YAAY,EAAG;MACjD;MACA,IAAKR,IAAI,CAACK,QAAQ,KAAK,IAAI,EAAG;QAC7B,IAAKL,IAAI,CAACS,WAAW,IAAIT,IAAI,CAACS,WAAW,CAACJ,QAAQ,KAAK,IAAI,EAAG;UAC7DR,IAAI,CAACS,WAAW,CAAEZ,OAAO,CAACa,aAAa,CAAE,GAAI,CAAE,CAAC;UAChDZ,IAAI,CAACQ,WAAW,CAAEH,IAAI,CAACS,WAAY,CAAC;QACrC;;QAEA;QACA,IACCZ,IAAI,CAACO,SAAS,IACdP,IAAI,CAACO,SAAS,CAACC,QAAQ,KAAK,GAAG,IAC/BR,IAAI,CAACO,SAAS,CAACM,aAAa,CAAC,CAAC,EAC7B;UACDb,IAAI,CAACO,SAAS,CAACE,WAAW,CAAEN,IAAK,CAAC;QACnC,CAAC,MAAM;UACNL,IAAI,CAACQ,WAAW,CAAEH,IAAK,CAAC;QACzB;MACD,CAAC,MAAM,IAAKA,IAAI,CAACK,QAAQ,KAAK,GAAG,EAAG;QACnC;QACA,IAAKnB,OAAO,CAAEc,IAAK,CAAC,EAAG;UACtBL,IAAI,CAACQ,WAAW,CAAEH,IAAK,CAAC;QACzB,CAAC,MAAM;UACNH,IAAI,CAACS,WAAW,CAAEN,IAAK,CAAC;QACzB;MACD,CAAC,MAAM,IAAKb,iBAAiB,CAAEa,IAAK,CAAC,EAAG;QACvC,IAAK,CAAEH,IAAI,CAACO,SAAS,IAAIP,IAAI,CAACO,SAAS,CAACC,QAAQ,KAAK,GAAG,EAAG;UAC1DR,IAAI,CAACS,WAAW,CAAEZ,OAAO,CAACa,aAAa,CAAE,GAAI,CAAE,CAAC;QACjD;QACAV,IAAI,CAACO,SAAS,CAACE,WAAW,CAAEN,IAAK,CAAC;MACnC,CAAC,MAAM;QACNH,IAAI,CAACS,WAAW,CAAEN,IAAK,CAAC;MACzB;IACD,CAAC,MAAM;MACNL,IAAI,CAACQ,WAAW,CAAEH,IAAK,CAAC;IACzB;EACD;EAEA,OAAOH,IAAI,CAACC,SAAS;AACtB"}