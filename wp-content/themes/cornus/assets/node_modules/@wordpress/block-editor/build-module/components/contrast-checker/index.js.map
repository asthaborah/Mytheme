{"version":3,"names":["a11yPlugin","namesPlugin","colord","extend","__","sprintf","Notice","speak","ContrastChecker","backgroundColor","fallbackBackgroundColor","fallbackTextColor","fallbackLinkColor","fontSize","isLargeText","textColor","linkColor","enableAlphaChecker","currentBackgroundColor","currentTextColor","currentLinkColor","textColors","color","description","colordBackgroundColor","backgroundColorHasTransparency","alpha","backgroundColorBrightness","brightness","isReadableOptions","level","size","message","speakMessage","item","colordTextColor","isColordTextReadable","isReadable","textHasTransparency","createElement","className","spokenMessage","status","isDismissible"],"sources":["@wordpress/block-editor/src/components/contrast-checker/index.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport a11yPlugin from 'colord/plugins/a11y';\nimport namesPlugin from 'colord/plugins/names';\nimport { colord, extend } from 'colord';\n\n/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport { Notice } from '@wordpress/components';\nimport { speak } from '@wordpress/a11y';\n\nextend( [ namesPlugin, a11yPlugin ] );\n\nfunction ContrastChecker( {\n\tbackgroundColor,\n\tfallbackBackgroundColor,\n\tfallbackTextColor,\n\tfallbackLinkColor,\n\tfontSize, // Font size value in pixels.\n\tisLargeText,\n\ttextColor,\n\tlinkColor,\n\tenableAlphaChecker = false,\n} ) {\n\tconst currentBackgroundColor = backgroundColor || fallbackBackgroundColor;\n\n\t// Must have a background color.\n\tif ( ! currentBackgroundColor ) {\n\t\treturn null;\n\t}\n\n\tconst currentTextColor = textColor || fallbackTextColor;\n\tconst currentLinkColor = linkColor || fallbackLinkColor;\n\n\t// Must have at least one text color.\n\tif ( ! currentTextColor && ! currentLinkColor ) {\n\t\treturn null;\n\t}\n\n\tconst textColors = [\n\t\t{\n\t\t\tcolor: currentTextColor,\n\t\t\tdescription: __( 'text color' ),\n\t\t},\n\t\t{\n\t\t\tcolor: currentLinkColor,\n\t\t\tdescription: __( 'link color' ),\n\t\t},\n\t];\n\tconst colordBackgroundColor = colord( currentBackgroundColor );\n\tconst backgroundColorHasTransparency = colordBackgroundColor.alpha() < 1;\n\tconst backgroundColorBrightness = colordBackgroundColor.brightness();\n\tconst isReadableOptions = {\n\t\tlevel: 'AA',\n\t\tsize:\n\t\t\tisLargeText || ( isLargeText !== false && fontSize >= 24 )\n\t\t\t\t? 'large'\n\t\t\t\t: 'small',\n\t};\n\n\tlet message = '';\n\tlet speakMessage = '';\n\tfor ( const item of textColors ) {\n\t\t// If there is no color, go no further.\n\t\tif ( ! item.color ) {\n\t\t\tcontinue;\n\t\t}\n\t\tconst colordTextColor = colord( item.color );\n\t\tconst isColordTextReadable = colordTextColor.isReadable(\n\t\t\tcolordBackgroundColor,\n\t\t\tisReadableOptions\n\t\t);\n\t\tconst textHasTransparency = colordTextColor.alpha() < 1;\n\n\t\t// If the contrast is not readable.\n\t\tif ( ! isColordTextReadable ) {\n\t\t\t// Don't show the message if the background or text is transparent.\n\t\t\tif ( backgroundColorHasTransparency || textHasTransparency ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tmessage =\n\t\t\t\tbackgroundColorBrightness < colordTextColor.brightness()\n\t\t\t\t\t? sprintf(\n\t\t\t\t\t\t\t// translators: %s is a type of text color, e.g., \"text color\" or \"link color\".\n\t\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t\t'This color combination may be hard for people to read. Try using a darker background color and/or a brighter %s.'\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\titem.description\n\t\t\t\t\t  )\n\t\t\t\t\t: sprintf(\n\t\t\t\t\t\t\t// translators: %s is a type of text color, e.g., \"text color\" or \"link color\".\n\t\t\t\t\t\t\t__(\n\t\t\t\t\t\t\t\t'This color combination may be hard for people to read. Try using a brighter background color and/or a darker %s.'\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\titem.description\n\t\t\t\t\t  );\n\t\t\tspeakMessage = __(\n\t\t\t\t'This color combination may be hard for people to read.'\n\t\t\t);\n\t\t\t// Break from the loop when we have a contrast warning.\n\t\t\t// These messages take priority over the transparency warning.\n\t\t\tbreak;\n\t\t}\n\n\t\t// If there is no contrast warning and the text is transparent,\n\t\t// show the transparent warning if alpha check is enabled.\n\t\tif ( textHasTransparency && enableAlphaChecker ) {\n\t\t\tmessage = __( 'Transparent text may be hard for people to read.' );\n\t\t\tspeakMessage = __(\n\t\t\t\t'Transparent text may be hard for people to read.'\n\t\t\t);\n\t\t}\n\t}\n\n\tif ( ! message ) {\n\t\treturn null;\n\t}\n\n\t// Note: The `Notice` component can speak messages via its `spokenMessage`\n\t// prop, but the contrast checker requires granular control over when the\n\t// announcements are made. Notably, the message will be re-announced if a\n\t// new color combination is selected and the contrast is still insufficient.\n\tspeak( speakMessage );\n\n\treturn (\n\t\t<div className=\"block-editor-contrast-checker\">\n\t\t\t<Notice\n\t\t\t\tspokenMessage={ null }\n\t\t\t\tstatus=\"warning\"\n\t\t\t\tisDismissible={ false }\n\t\t\t>\n\t\t\t\t{ message }\n\t\t\t</Notice>\n\t\t</div>\n\t);\n}\n\n/**\n * @see https://github.com/WordPress/gutenberg/blob/HEAD/packages/block-editor/src/components/contrast-checker/README.md\n */\nexport default ContrastChecker;\n"],"mappings":"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"}