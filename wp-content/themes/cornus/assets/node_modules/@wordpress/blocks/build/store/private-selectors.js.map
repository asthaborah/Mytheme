{"version":3,"names":["_rememo","_interopRequireDefault","require","_selectors","_utils","_constants","ROOT_BLOCK_SUPPORTS","filterElementBlockSupports","blockSupports","name","element","filter","support","includes","getSupportedStyles","exports","createSelector","state","blockType","getBlockType","supportKeys","supports","spacing","blockGap","push","shadow","Object","keys","STYLE_PROPERTY","forEach","styleName","requiresOptOut","getValueFromObjectPath","blockTypes","getBootstrappedBlockType","bootstrappedBlockTypes","getUnprocessedBlockTypes","unprocessedBlockTypes","getAllBlockBindingsSources","blockBindingsSources","getBlockBindingsSource","sourceName"],"sources":["@wordpress/blocks/src/store/private-selectors.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport createSelector from 'rememo';\n\n/**\n * Internal dependencies\n */\nimport { getBlockType } from './selectors';\nimport { getValueFromObjectPath } from './utils';\nimport { __EXPERIMENTAL_STYLE_PROPERTY as STYLE_PROPERTY } from '../api/constants';\n\nconst ROOT_BLOCK_SUPPORTS = [\n\t'background',\n\t'backgroundColor',\n\t'color',\n\t'linkColor',\n\t'captionColor',\n\t'buttonColor',\n\t'headingColor',\n\t'fontFamily',\n\t'fontSize',\n\t'fontStyle',\n\t'fontWeight',\n\t'lineHeight',\n\t'padding',\n\t'contentSize',\n\t'wideSize',\n\t'blockGap',\n\t'textDecoration',\n\t'textTransform',\n\t'letterSpacing',\n];\n\n/**\n * Filters the list of supported styles for a given element.\n *\n * @param {string[]}         blockSupports list of supported styles.\n * @param {string|undefined} name          block name.\n * @param {string|undefined} element       element name.\n *\n * @return {string[]} filtered list of supported styles.\n */\nfunction filterElementBlockSupports( blockSupports, name, element ) {\n\treturn blockSupports.filter( ( support ) => {\n\t\tif ( support === 'fontSize' && element === 'heading' ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// This is only available for links\n\t\tif ( support === 'textDecoration' && ! name && element !== 'link' ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// This is only available for heading, button, caption and text\n\t\tif (\n\t\t\tsupport === 'textTransform' &&\n\t\t\t! name &&\n\t\t\t! (\n\t\t\t\t[ 'heading', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6' ].includes(\n\t\t\t\t\telement\n\t\t\t\t) ||\n\t\t\t\telement === 'button' ||\n\t\t\t\telement === 'caption' ||\n\t\t\t\telement === 'text'\n\t\t\t)\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// This is only available for heading, button, caption and text\n\t\tif (\n\t\t\tsupport === 'letterSpacing' &&\n\t\t\t! name &&\n\t\t\t! (\n\t\t\t\t[ 'heading', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6' ].includes(\n\t\t\t\t\telement\n\t\t\t\t) ||\n\t\t\t\telement === 'button' ||\n\t\t\t\telement === 'caption' ||\n\t\t\t\telement === 'text'\n\t\t\t)\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Text columns is only available for blocks.\n\t\tif ( support === 'textColumns' && ! name ) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} );\n}\n\n/**\n * Returns the list of supported styles for a given block name and element.\n */\nexport const getSupportedStyles = createSelector(\n\t( state, name, element ) => {\n\t\tif ( ! name ) {\n\t\t\treturn filterElementBlockSupports(\n\t\t\t\tROOT_BLOCK_SUPPORTS,\n\t\t\t\tname,\n\t\t\t\telement\n\t\t\t);\n\t\t}\n\n\t\tconst blockType = getBlockType( state, name );\n\n\t\tif ( ! blockType ) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst supportKeys = [];\n\n\t\t// Check for blockGap support.\n\t\t// Block spacing support doesn't map directly to a single style property, so needs to be handled separately.\n\t\tif ( blockType?.supports?.spacing?.blockGap ) {\n\t\t\tsupportKeys.push( 'blockGap' );\n\t\t}\n\n\t\t// check for shadow support\n\t\tif ( blockType?.supports?.shadow ) {\n\t\t\tsupportKeys.push( 'shadow' );\n\t\t}\n\n\t\tObject.keys( STYLE_PROPERTY ).forEach( ( styleName ) => {\n\t\t\tif ( ! STYLE_PROPERTY[ styleName ].support ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Opting out means that, for certain support keys like background color,\n\t\t\t// blocks have to explicitly set the support value false. If the key is\n\t\t\t// unset, we still enable it.\n\t\t\tif ( STYLE_PROPERTY[ styleName ].requiresOptOut ) {\n\t\t\t\tif (\n\t\t\t\t\tSTYLE_PROPERTY[ styleName ].support[ 0 ] in\n\t\t\t\t\t\tblockType.supports &&\n\t\t\t\t\tgetValueFromObjectPath(\n\t\t\t\t\t\tblockType.supports,\n\t\t\t\t\t\tSTYLE_PROPERTY[ styleName ].support\n\t\t\t\t\t) !== false\n\t\t\t\t) {\n\t\t\t\t\tsupportKeys.push( styleName );\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tgetValueFromObjectPath(\n\t\t\t\t\tblockType.supports,\n\t\t\t\t\tSTYLE_PROPERTY[ styleName ].support,\n\t\t\t\t\tfalse\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tsupportKeys.push( styleName );\n\t\t\t}\n\t\t} );\n\n\t\treturn filterElementBlockSupports( supportKeys, name, element );\n\t},\n\t( state, name ) => [ state.blockTypes[ name ] ]\n);\n\n/**\n * Returns the bootstrapped block type metadata for a give block name.\n *\n * @param {Object} state Data state.\n * @param {string} name  Block name.\n *\n * @return {Object} Bootstrapped block type metadata for a block.\n */\nexport function getBootstrappedBlockType( state, name ) {\n\treturn state.bootstrappedBlockTypes[ name ];\n}\n\n/**\n * Returns all the unprocessed (before applying the `registerBlockType` filter)\n * block type settings as passed during block registration.\n *\n * @param {Object} state Data state.\n *\n * @return {Array} Unprocessed block type settings for all blocks.\n */\nexport function getUnprocessedBlockTypes( state ) {\n\treturn state.unprocessedBlockTypes;\n}\n\n/**\n * Returns all the block bindings sources registered.\n *\n * @param {Object} state Data state.\n *\n * @return {Object} All the registered sources and their properties.\n */\nexport function getAllBlockBindingsSources( state ) {\n\treturn state.blockBindingsSources;\n}\n\n/**\n * Returns a specific block bindings source.\n *\n * @param {Object} state      Data state.\n * @param {string} sourceName Name of the source to get.\n *\n * @return {Object} The specific block binding source and its properties.\n */\nexport function getBlockBindingsSource( state, sourceName ) {\n\treturn state.blockBindingsSources[ sourceName ];\n}\n"],"mappings":"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"}