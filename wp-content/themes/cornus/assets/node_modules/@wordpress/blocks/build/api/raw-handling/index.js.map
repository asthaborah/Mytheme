{"version":3,"names":["_deprecated","_interopRequireDefault","require","_dom","_htmlToBlocks","_parser","_normaliseBlocks","_specialCommentConverter","_listReducer","_blockquoteNormaliser","_figureContentReducer","_shortcodeConverter","_utils","_pasteHandler","deprecatedGetPhrasingContentSchema","context","deprecated","since","alternative","getPhrasingContentSchema","rawHandler","HTML","indexOf","parse","pieces","shortcodeConverter","blockContentSchema","getBlockContentSchema","map","piece","filters","listReducer","specialCommentConverter","figureContentReducer","blockquoteNormaliser","deepFilterHTML","normaliseBlocks","htmlToBlocks","flat","filter","Boolean"],"sources":["@wordpress/blocks/src/api/raw-handling/index.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport deprecated from '@wordpress/deprecated';\nimport { getPhrasingContentSchema } from '@wordpress/dom';\n\n/**\n * Internal dependencies\n */\nimport { htmlToBlocks } from './html-to-blocks';\nimport parse from '../parser';\nimport normaliseBlocks from './normalise-blocks';\nimport specialCommentConverter from './special-comment-converter';\nimport listReducer from './list-reducer';\nimport blockquoteNormaliser from './blockquote-normaliser';\nimport figureContentReducer from './figure-content-reducer';\nimport shortcodeConverter from './shortcode-converter';\nimport { deepFilterHTML, getBlockContentSchema } from './utils';\n\nexport { pasteHandler } from './paste-handler';\n\nexport function deprecatedGetPhrasingContentSchema( context ) {\n\tdeprecated( 'wp.blocks.getPhrasingContentSchema', {\n\t\tsince: '5.6',\n\t\talternative: 'wp.dom.getPhrasingContentSchema',\n\t} );\n\treturn getPhrasingContentSchema( context );\n}\n\n/**\n * Converts an HTML string to known blocks.\n *\n * @param {Object} $1\n * @param {string} $1.HTML The HTML to convert.\n *\n * @return {Array} A list of blocks.\n */\nexport function rawHandler( { HTML = '' } ) {\n\t// If we detect block delimiters, parse entirely as blocks.\n\tif ( HTML.indexOf( '<!-- wp:' ) !== -1 ) {\n\t\treturn parse( HTML );\n\t}\n\n\t// An array of HTML strings and block objects. The blocks replace matched\n\t// shortcodes.\n\tconst pieces = shortcodeConverter( HTML );\n\tconst blockContentSchema = getBlockContentSchema();\n\n\treturn pieces\n\t\t.map( ( piece ) => {\n\t\t\t// Already a block from shortcode.\n\t\t\tif ( typeof piece !== 'string' ) {\n\t\t\t\treturn piece;\n\t\t\t}\n\n\t\t\t// These filters are essential for some blocks to be able to transform\n\t\t\t// from raw HTML. These filters move around some content or add\n\t\t\t// additional tags, they do not remove any content.\n\t\t\tconst filters = [\n\t\t\t\t// Needed to adjust invalid lists.\n\t\t\t\tlistReducer,\n\t\t\t\t// Needed to create more and nextpage blocks.\n\t\t\t\tspecialCommentConverter,\n\t\t\t\t// Needed to create media blocks.\n\t\t\t\tfigureContentReducer,\n\t\t\t\t// Needed to create the quote block, which cannot handle text\n\t\t\t\t// without wrapper paragraphs.\n\t\t\t\tblockquoteNormaliser,\n\t\t\t];\n\n\t\t\tpiece = deepFilterHTML( piece, filters, blockContentSchema );\n\t\t\tpiece = normaliseBlocks( piece );\n\n\t\t\treturn htmlToBlocks( piece, rawHandler );\n\t\t} )\n\t\t.flat()\n\t\t.filter( Boolean );\n}\n"],"mappings":";;;;;;;;;;;;;;AAGA,IAAAA,WAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,IAAA,GAAAD,OAAA;AAKA,IAAAE,aAAA,GAAAF,OAAA;AACA,IAAAG,OAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,gBAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,wBAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,YAAA,GAAAP,sBAAA,CAAAC,OAAA;AACA,IAAAO,qBAAA,GAAAR,sBAAA,CAAAC,OAAA;AACA,IAAAQ,qBAAA,GAAAT,sBAAA,CAAAC,OAAA;AACA,IAAAS,mBAAA,GAAAV,sBAAA,CAAAC,OAAA;AACA,IAAAU,MAAA,GAAAV,OAAA;AAEA,IAAAW,aAAA,GAAAX,OAAA;AAnBA;AACA;AACA;;AAIA;AACA;AACA;;AAaO,SAASY,kCAAkCA,CAAEC,OAAO,EAAG;EAC7D,IAAAC,mBAAU,EAAE,oCAAoC,EAAE;IACjDC,KAAK,EAAE,KAAK;IACZC,WAAW,EAAE;EACd,CAAE,CAAC;EACH,OAAO,IAAAC,6BAAwB,EAAEJ,OAAQ,CAAC;AAC3C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASK,UAAUA,CAAE;EAAEC,IAAI,GAAG;AAAG,CAAC,EAAG;EAC3C;EACA,IAAKA,IAAI,CAACC,OAAO,CAAE,UAAW,CAAC,KAAK,CAAC,CAAC,EAAG;IACxC,OAAO,IAAAC,eAAK,EAAEF,IAAK,CAAC;EACrB;;EAEA;EACA;EACA,MAAMG,MAAM,GAAG,IAAAC,2BAAkB,EAAEJ,IAAK,CAAC;EACzC,MAAMK,kBAAkB,GAAG,IAAAC,4BAAqB,EAAC,CAAC;EAElD,OAAOH,MAAM,CACXI,GAAG,CAAIC,KAAK,IAAM;IAClB;IACA,IAAK,OAAOA,KAAK,KAAK,QAAQ,EAAG;MAChC,OAAOA,KAAK;IACb;;IAEA;IACA;IACA;IACA,MAAMC,OAAO,GAAG;IACf;IACAC,oBAAW;IACX;IACAC,gCAAuB;IACvB;IACAC,6BAAoB;IACpB;IACA;IACAC,6BAAoB,CACpB;IAEDL,KAAK,GAAG,IAAAM,qBAAc,EAAEN,KAAK,EAAEC,OAAO,EAAEJ,kBAAmB,CAAC;IAC5DG,KAAK,GAAG,IAAAO,wBAAe,EAAEP,KAAM,CAAC;IAEhC,OAAO,IAAAQ,0BAAY,EAAER,KAAK,EAAET,UAAW,CAAC;EACzC,CAAE,CAAC,CACFkB,IAAI,CAAC,CAAC,CACNC,MAAM,CAAEC,OAAQ,CAAC;AACpB"}