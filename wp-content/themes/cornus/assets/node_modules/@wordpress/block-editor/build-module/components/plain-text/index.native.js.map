{"version":3,"names":["TextInput","Platform","Dimensions","Component","getPxFromCssUnit","RichText","styles","PlainText","constructor","arguments","isAndroid","OS","onChangeTextInput","bind","onChangeRichText","componentDidMount","_input","isFocused","props","isSelected","timeoutID","setTimeout","focus","componentDidUpdate","prevProps","blur","componentWillUnmount","clearTimeout","getFontSize","style","fontSize","width","height","get","cssUnitOptions","parseFloat","replaceLineBreakTags","value","replace","RegExp","event","onChange","nativeEvent","text","render","__experimentalVersion","onFocus","otherProps","textStyles","disableFormattingProps","withoutInteractiveFormatting","disableEditingMenu","__unstableDisableFormats","disableSuggestions","forcePlainTextProps","preserveWhiteSpace","__unstablePastePlainText","multiline","fontProps","fontFamily","fontWeight","createElement","identifier","unstableOnFocus","ref","x","onBlur","scrollEnabled"],"sources":["@wordpress/block-editor/src/components/plain-text/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { TextInput, Platform, Dimensions } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { getPxFromCssUnit } from '@wordpress/components';\n\n/**\n * Internal dependencies\n */\nimport RichText from '../rich-text';\n\n/**\n * Internal dependencies\n */\nimport styles from './style.scss';\n\nexport default class PlainText extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\t\tthis.isAndroid = Platform.OS === 'android';\n\n\t\tthis.onChangeTextInput = this.onChangeTextInput.bind( this );\n\t\tthis.onChangeRichText = this.onChangeRichText.bind( this );\n\t}\n\n\tcomponentDidMount() {\n\t\t// If isSelected is true, we should request the focus on this TextInput.\n\t\tif (\n\t\t\tthis._input &&\n\t\t\tthis._input.isFocused() === false &&\n\t\t\tthis.props.isSelected\n\t\t) {\n\t\t\tif ( this.isAndroid ) {\n\t\t\t\t/*\n\t\t\t\t * There seems to be an issue in React Native where the keyboard doesn't show if called shortly after rendering.\n\t\t\t\t * As a common work around this delay is used.\n\t\t\t\t * https://github.com/facebook/react-native/issues/19366#issuecomment-400603928\n\t\t\t\t */\n\t\t\t\tthis.timeoutID = setTimeout( () => {\n\t\t\t\t\tthis._input.focus();\n\t\t\t\t}, 100 );\n\t\t\t} else {\n\t\t\t\tthis._input.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tif ( ! this.props.isSelected && prevProps.isSelected ) {\n\t\t\tthis._input?.blur();\n\t\t}\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif ( this.isAndroid ) {\n\t\t\tclearTimeout( this.timeoutID );\n\t\t}\n\t}\n\n\tfocus() {\n\t\tthis._input?.focus();\n\t}\n\n\tblur() {\n\t\tthis._input?.blur();\n\t}\n\n\tgetFontSize() {\n\t\tconst { style } = this.props;\n\n\t\tif ( ! style?.fontSize ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { width, height } = Dimensions.get( 'window' );\n\t\tconst cssUnitOptions = { height, width };\n\n\t\treturn {\n\t\t\tfontSize: parseFloat(\n\t\t\t\tgetPxFromCssUnit( style.fontSize, cssUnitOptions )\n\t\t\t),\n\t\t};\n\t}\n\n\treplaceLineBreakTags( value ) {\n\t\treturn value?.replace( RegExp( '<br>', 'gim' ), '\\n' );\n\t}\n\n\tonChangeTextInput( event ) {\n\t\tconst { onChange } = this.props;\n\t\tonChange( event.nativeEvent.text );\n\t}\n\n\tonChangeRichText( value ) {\n\t\tconst { onChange } = this.props;\n\t\t// The <br> tags have to be replaced with new line characters\n\t\t// as the content of plain text shouldn't contain HTML tags.\n\t\tonChange( this.replaceLineBreakTags( value ) );\n\t}\n\n\trender() {\n\t\tconst { style, __experimentalVersion, onFocus, ...otherProps } =\n\t\t\tthis.props;\n\t\tconst textStyles = [\n\t\t\tstyle || styles[ 'block-editor-plain-text' ],\n\t\t\tthis.getFontSize(),\n\t\t];\n\n\t\tif ( __experimentalVersion === 2 ) {\n\t\t\tconst disableFormattingProps = {\n\t\t\t\twithoutInteractiveFormatting: true,\n\t\t\t\tdisableEditingMenu: true,\n\t\t\t\t__unstableDisableFormats: true,\n\t\t\t\tdisableSuggestions: true,\n\t\t\t};\n\n\t\t\tconst forcePlainTextProps = {\n\t\t\t\tpreserveWhiteSpace: true,\n\t\t\t\t__unstablePastePlainText: true,\n\t\t\t\tmultiline: false,\n\t\t\t};\n\n\t\t\tconst fontProps = {\n\t\t\t\tfontFamily: style?.fontFamily,\n\t\t\t\tfontSize: style?.fontSize,\n\t\t\t\tfontWeight: style?.fontWeight,\n\t\t\t};\n\n\t\t\treturn (\n\t\t\t\t<RichText\n\t\t\t\t\t{ ...otherProps }\n\t\t\t\t\t{ ...disableFormattingProps }\n\t\t\t\t\t{ ...forcePlainTextProps }\n\t\t\t\t\t{ ...fontProps }\n\t\t\t\t\tidentifier=\"content\"\n\t\t\t\t\tstyle={ style }\n\t\t\t\t\tonChange={ this.onChangeRichText }\n\t\t\t\t\tunstableOnFocus={ onFocus }\n\t\t\t\t/>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<TextInput\n\t\t\t\t{ ...this.props }\n\t\t\t\tref={ ( x ) => ( this._input = x ) }\n\t\t\t\tonChange={ this.onChangeTextInput }\n\t\t\t\tonFocus={ this.props.onFocus } // Always assign onFocus as a props.\n\t\t\t\tonBlur={ this.props.onBlur } // Always assign onBlur as a props.\n\t\t\t\tfontFamily={\n\t\t\t\t\t( this.props.style && this.props.style.fontFamily ) ||\n\t\t\t\t\tstyles[ 'block-editor-plain-text' ].fontFamily\n\t\t\t\t}\n\t\t\t\tstyle={ textStyles }\n\t\t\t\tscrollEnabled={ false }\n\t\t\t/>\n\t\t);\n\t}\n}\n"],"mappings":"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"}