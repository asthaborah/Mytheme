{"version":3,"names":["useRef","useRefEffect","toHTMLString","isCollapsed","slice","getTextContent","useCopyHandler","props","propsRef","current","element","onCopy","event","record","ownerDocument","contains","activeElement","selectedRecord","plainText","html","value","clipboardData","setData","preventDefault","type","execCommand","addEventListener","removeEventListener"],"sources":["@wordpress/rich-text/src/component/use-copy-handler.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useRef } from '@wordpress/element';\nimport { useRefEffect } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { toHTMLString } from '../to-html-string';\nimport { isCollapsed } from '../is-collapsed';\nimport { slice } from '../slice';\nimport { getTextContent } from '../get-text-content';\n\nexport function useCopyHandler( props ) {\n\tconst propsRef = useRef( props );\n\tpropsRef.current = props;\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onCopy( event ) {\n\t\t\tconst { record } = propsRef.current;\n\t\t\tconst { ownerDocument } = element;\n\t\t\tif (\n\t\t\t\tisCollapsed( record.current ) ||\n\t\t\t\t! element.contains( ownerDocument.activeElement )\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst selectedRecord = slice( record.current );\n\t\t\tconst plainText = getTextContent( selectedRecord );\n\t\t\tconst html = toHTMLString( { value: selectedRecord } );\n\t\t\tevent.clipboardData.setData( 'text/plain', plainText );\n\t\t\tevent.clipboardData.setData( 'text/html', html );\n\t\t\tevent.clipboardData.setData( 'rich-text', 'true' );\n\t\t\tevent.preventDefault();\n\n\t\t\tif ( event.type === 'cut' ) {\n\t\t\t\townerDocument.execCommand( 'delete' );\n\t\t\t}\n\t\t}\n\n\t\telement.addEventListener( 'copy', onCopy );\n\t\telement.addEventListener( 'cut', onCopy );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'copy', onCopy );\n\t\t\telement.removeEventListener( 'cut', onCopy );\n\t\t};\n\t}, [] );\n}\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,MAAM,QAAQ,oBAAoB;AAC3C,SAASC,YAAY,QAAQ,oBAAoB;;AAEjD;AACA;AACA;AACA,SAASC,YAAY,QAAQ,mBAAmB;AAChD,SAASC,WAAW,QAAQ,iBAAiB;AAC7C,SAASC,KAAK,QAAQ,UAAU;AAChC,SAASC,cAAc,QAAQ,qBAAqB;AAEpD,OAAO,SAASC,cAAcA,CAAEC,KAAK,EAAG;EACvC,MAAMC,QAAQ,GAAGR,MAAM,CAAEO,KAAM,CAAC;EAChCC,QAAQ,CAACC,OAAO,GAAGF,KAAK;EACxB,OAAON,YAAY,CAAIS,OAAO,IAAM;IACnC,SAASC,MAAMA,CAAEC,KAAK,EAAG;MACxB,MAAM;QAAEC;MAAO,CAAC,GAAGL,QAAQ,CAACC,OAAO;MACnC,MAAM;QAAEK;MAAc,CAAC,GAAGJ,OAAO;MACjC,IACCP,WAAW,CAAEU,MAAM,CAACJ,OAAQ,CAAC,IAC7B,CAAEC,OAAO,CAACK,QAAQ,CAAED,aAAa,CAACE,aAAc,CAAC,EAChD;QACD;MACD;MAEA,MAAMC,cAAc,GAAGb,KAAK,CAAES,MAAM,CAACJ,OAAQ,CAAC;MAC9C,MAAMS,SAAS,GAAGb,cAAc,CAAEY,cAAe,CAAC;MAClD,MAAME,IAAI,GAAGjB,YAAY,CAAE;QAAEkB,KAAK,EAAEH;MAAe,CAAE,CAAC;MACtDL,KAAK,CAACS,aAAa,CAACC,OAAO,CAAE,YAAY,EAAEJ,SAAU,CAAC;MACtDN,KAAK,CAACS,aAAa,CAACC,OAAO,CAAE,WAAW,EAAEH,IAAK,CAAC;MAChDP,KAAK,CAACS,aAAa,CAACC,OAAO,CAAE,WAAW,EAAE,MAAO,CAAC;MAClDV,KAAK,CAACW,cAAc,CAAC,CAAC;MAEtB,IAAKX,KAAK,CAACY,IAAI,KAAK,KAAK,EAAG;QAC3BV,aAAa,CAACW,WAAW,CAAE,QAAS,CAAC;MACtC;IACD;IAEAf,OAAO,CAACgB,gBAAgB,CAAE,MAAM,EAAEf,MAAO,CAAC;IAC1CD,OAAO,CAACgB,gBAAgB,CAAE,KAAK,EAAEf,MAAO,CAAC;IACzC,OAAO,MAAM;MACZD,OAAO,CAACiB,mBAAmB,CAAE,MAAM,EAAEhB,MAAO,CAAC;MAC7CD,OAAO,CAACiB,mBAAmB,CAAE,KAAK,EAAEhB,MAAO,CAAC;IAC7C,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;AACR"}