{"version":3,"names":["useSelect","useDispatch","setBlockTypeImpressions","store","blockEditorStore","useBlockTypeImpressions","blockTypes","blockTypeImpressions","select","getSettings","getBlockEditorSettings","impressions","updateSettings","items","map","blockType","isNew","name","trackBlockTypeSelected","updatedBlockTypeImpressions"],"sources":["@wordpress/block-editor/src/components/inserter/hooks/use-block-type-impressions.native.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect, useDispatch } from '@wordpress/data';\nimport { setBlockTypeImpressions } from '@wordpress/react-native-bridge';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../../../store';\n\nfunction useBlockTypeImpressions( blockTypes ) {\n\tconst { blockTypeImpressions } = useSelect( ( select ) => {\n\t\tconst { getSettings: getBlockEditorSettings } =\n\t\t\tselect( blockEditorStore );\n\t\tconst { impressions } = getBlockEditorSettings();\n\n\t\treturn {\n\t\t\tblockTypeImpressions: impressions,\n\t\t};\n\t}, [] );\n\tconst { updateSettings } = useDispatch( blockEditorStore );\n\n\tconst items = blockTypes.map( ( blockType ) => ( {\n\t\t...blockType,\n\t\tisNew: blockTypeImpressions[ blockType.name ] > 0,\n\t} ) );\n\tconst trackBlockTypeSelected = ( { name } ) => {\n\t\tif ( blockTypeImpressions[ name ] > 0 ) {\n\t\t\tconst updatedBlockTypeImpressions = {\n\t\t\t\t...blockTypeImpressions,\n\t\t\t\t[ name ]: 0,\n\t\t\t};\n\t\t\t// Persist block type impression to JavaScript store.\n\t\t\tupdateSettings( {\n\t\t\t\timpressions: updatedBlockTypeImpressions,\n\t\t\t} );\n\n\t\t\t// Persist block type impression count to native app store.\n\t\t\tsetBlockTypeImpressions( updatedBlockTypeImpressions );\n\t\t}\n\t};\n\n\treturn { items, trackBlockTypeSelected };\n}\n\nexport default useBlockTypeImpressions;\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,EAAEC,WAAW,QAAQ,iBAAiB;AACxD,SAASC,uBAAuB,QAAQ,gCAAgC;;AAExE;AACA;AACA;AACA,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,gBAAgB;AAE1D,SAASC,uBAAuBA,CAAEC,UAAU,EAAG;EAC9C,MAAM;IAAEC;EAAqB,CAAC,GAAGP,SAAS,CAAIQ,MAAM,IAAM;IACzD,MAAM;MAAEC,WAAW,EAAEC;IAAuB,CAAC,GAC5CF,MAAM,CAAEJ,gBAAiB,CAAC;IAC3B,MAAM;MAAEO;IAAY,CAAC,GAAGD,sBAAsB,CAAC,CAAC;IAEhD,OAAO;MACNH,oBAAoB,EAAEI;IACvB,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;EACP,MAAM;IAAEC;EAAe,CAAC,GAAGX,WAAW,CAAEG,gBAAiB,CAAC;EAE1D,MAAMS,KAAK,GAAGP,UAAU,CAACQ,GAAG,CAAIC,SAAS,KAAQ;IAChD,GAAGA,SAAS;IACZC,KAAK,EAAET,oBAAoB,CAAEQ,SAAS,CAACE,IAAI,CAAE,GAAG;EACjD,CAAC,CAAG,CAAC;EACL,MAAMC,sBAAsB,GAAGA,CAAE;IAAED;EAAK,CAAC,KAAM;IAC9C,IAAKV,oBAAoB,CAAEU,IAAI,CAAE,GAAG,CAAC,EAAG;MACvC,MAAME,2BAA2B,GAAG;QACnC,GAAGZ,oBAAoB;QACvB,CAAEU,IAAI,GAAI;MACX,CAAC;MACD;MACAL,cAAc,CAAE;QACfD,WAAW,EAAEQ;MACd,CAAE,CAAC;;MAEH;MACAjB,uBAAuB,CAAEiB,2BAA4B,CAAC;IACvD;EACD,CAAC;EAED,OAAO;IAAEN,KAAK;IAAEK;EAAuB,CAAC;AACzC;AAEA,eAAeb,uBAAuB"}