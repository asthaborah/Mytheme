{"version":3,"names":["View","Text","BottomSheet","Icon","TextControl","requestUnsupportedBlockFallback","sendActionButtonPressedAction","actionButtons","help","__","usePreferredColorSchemeStyle","getBlockType","useCallback","useState","applyFilters","styles","useUnsupportedBlockEditor","EMPTY_ARRAY","UnsupportedBlockDetails","clientId","showSheet","onCloseSheet","customBlockTitle","icon","title","description","actionButtonLabel","customActions","sendFallbackMessage","setSendFallbackMessage","sendButtonPressMessage","setSendButtonPressMessage","blockName","blockContent","isUnsupportedBlockEditorSupported","canEnableUnsupportedBlockEditor","isEditableInUnsupportedBlockEditor","textStyle","titleStyle","descriptionStyle","iconStyle","actionButtonStyle","blockTitle","requestFallback","descriptionWithNotes","webEditorDefaultLabel","canUseWebEditor","actions","label","onPress","filter","Boolean","createElement","isVisible","hideHeader","onClose","onModalHide","timeout","setTimeout","missingBlockAlertActionButton","style","color","size","map","index","key","separatorType","labelStyle"],"sources":["@wordpress/block-editor/src/components/unsupported-block-details/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { View, Text } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { BottomSheet, Icon, TextControl } from '@wordpress/components';\nimport {\n\trequestUnsupportedBlockFallback,\n\tsendActionButtonPressedAction,\n\tactionButtons,\n} from '@wordpress/react-native-bridge';\nimport { help } from '@wordpress/icons';\nimport { __ } from '@wordpress/i18n';\nimport { usePreferredColorSchemeStyle } from '@wordpress/compose';\nimport { getBlockType } from '@wordpress/blocks';\nimport { useCallback, useState } from '@wordpress/element';\nimport { applyFilters } from '@wordpress/hooks';\n\n/**\n * Internal dependencies\n */\nimport styles from './style.scss';\nimport useUnsupportedBlockEditor from '../use-unsupported-block-editor';\n\nconst EMPTY_ARRAY = [];\n\nconst UnsupportedBlockDetails = ( {\n\tclientId,\n\tshowSheet,\n\tonCloseSheet,\n\tcustomBlockTitle = '',\n\ticon,\n\ttitle,\n\tdescription,\n\tactionButtonLabel,\n\tcustomActions = EMPTY_ARRAY,\n} ) => {\n\tconst [ sendFallbackMessage, setSendFallbackMessage ] = useState( false );\n\tconst [ sendButtonPressMessage, setSendButtonPressMessage ] =\n\t\tuseState( false );\n\n\tconst {\n\t\tblockName,\n\t\tblockContent,\n\t\tisUnsupportedBlockEditorSupported,\n\t\tcanEnableUnsupportedBlockEditor,\n\t\tisEditableInUnsupportedBlockEditor,\n\t} = useUnsupportedBlockEditor( clientId );\n\n\t// Styles\n\tconst textStyle = usePreferredColorSchemeStyle(\n\t\tstyles[ 'unsupported-block-details__text' ],\n\t\tstyles[ 'unsupported-block-details__text--dark' ]\n\t);\n\tconst titleStyle = usePreferredColorSchemeStyle(\n\t\tstyles[ 'unsupported-block-details__title' ],\n\t\tstyles[ 'unsupported-block-details__title--dark' ]\n\t);\n\tconst descriptionStyle = usePreferredColorSchemeStyle(\n\t\tstyles[ 'unsupported-block-details__description' ],\n\t\tstyles[ 'unsupported-block-details__description--dark' ]\n\t);\n\tconst iconStyle = usePreferredColorSchemeStyle(\n\t\tstyles[ 'unsupported-block-details__icon' ],\n\t\tstyles[ 'unsupported-block-details__icon--dark' ]\n\t);\n\tconst actionButtonStyle = usePreferredColorSchemeStyle(\n\t\tstyles[ 'unsupported-block-details__action-button' ],\n\t\tstyles[ 'unsupported-block-details__action-button--dark' ]\n\t);\n\n\tconst blockTitle =\n\t\tcustomBlockTitle || getBlockType( blockName )?.title || blockName;\n\n\tconst requestFallback = useCallback( () => {\n\t\tif (\n\t\t\tcanEnableUnsupportedBlockEditor &&\n\t\t\tisUnsupportedBlockEditorSupported === false\n\t\t) {\n\t\t\tonCloseSheet();\n\t\t\tsetSendButtonPressMessage( true );\n\t\t} else {\n\t\t\tonCloseSheet();\n\t\t\tsetSendFallbackMessage( true );\n\t\t}\n\t}, [\n\t\tcanEnableUnsupportedBlockEditor,\n\t\tisUnsupportedBlockEditorSupported,\n\t\tonCloseSheet,\n\t] );\n\n\t// The description can include extra notes via WP hooks.\n\tconst descriptionWithNotes = applyFilters(\n\t\t'native.unsupported_block_details_extra_note',\n\t\tdescription,\n\t\tblockName\n\t);\n\n\tconst webEditorDefaultLabel = applyFilters(\n\t\t'native.unsupported_block_details_web_editor_action',\n\t\t__( 'Edit using web editor' )\n\t);\n\n\tconst canUseWebEditor =\n\t\t( isUnsupportedBlockEditorSupported ||\n\t\t\tcanEnableUnsupportedBlockEditor ) &&\n\t\tisEditableInUnsupportedBlockEditor;\n\tconst actions = [\n\t\t...[\n\t\t\tcanUseWebEditor && {\n\t\t\t\tlabel: actionButtonLabel || webEditorDefaultLabel,\n\t\t\t\tonPress: requestFallback,\n\t\t\t},\n\t\t],\n\t\t...customActions,\n\t].filter( Boolean );\n\n\treturn (\n\t\t<BottomSheet\n\t\t\tisVisible={ showSheet }\n\t\t\thideHeader\n\t\t\tonClose={ onCloseSheet }\n\t\t\tonModalHide={ () => {\n\t\t\t\tif ( sendFallbackMessage ) {\n\t\t\t\t\t// On iOS, onModalHide is called when the controller is still part of the hierarchy.\n\t\t\t\t\t// A small delay will ensure that the controller has already been removed.\n\t\t\t\t\tthis.timeout = setTimeout( () => {\n\t\t\t\t\t\t// For the Classic block, the content is kept in the `content` attribute.\n\t\t\t\t\t\trequestUnsupportedBlockFallback(\n\t\t\t\t\t\t\tblockContent,\n\t\t\t\t\t\t\tclientId,\n\t\t\t\t\t\t\tblockName,\n\t\t\t\t\t\t\tblockTitle\n\t\t\t\t\t\t);\n\t\t\t\t\t}, 100 );\n\t\t\t\t\tsetSendFallbackMessage( false );\n\t\t\t\t} else if ( sendButtonPressMessage ) {\n\t\t\t\t\tthis.timeout = setTimeout( () => {\n\t\t\t\t\t\tsendActionButtonPressedAction(\n\t\t\t\t\t\t\tactionButtons.missingBlockAlertActionButton\n\t\t\t\t\t\t);\n\t\t\t\t\t}, 100 );\n\t\t\t\t\tsetSendButtonPressMessage( false );\n\t\t\t\t}\n\t\t\t} }\n\t\t>\n\t\t\t<View style={ styles[ 'unsupported-block-details__container' ] }>\n\t\t\t\t<Icon\n\t\t\t\t\ticon={ icon || help }\n\t\t\t\t\tcolor={ iconStyle.color }\n\t\t\t\t\tsize={ iconStyle.size }\n\t\t\t\t/>\n\t\t\t\t<Text style={ [ textStyle, titleStyle ] }>{ title }</Text>\n\t\t\t\t{ isEditableInUnsupportedBlockEditor &&\n\t\t\t\t\tdescriptionWithNotes && (\n\t\t\t\t\t\t<Text style={ [ textStyle, descriptionStyle ] }>\n\t\t\t\t\t\t\t{ descriptionWithNotes }\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t) }\n\t\t\t</View>\n\t\t\t{ actions.map( ( { label, onPress }, index ) => (\n\t\t\t\t<TextControl\n\t\t\t\t\tkey={ `${ label } - ${ index }` }\n\t\t\t\t\tlabel={ label }\n\t\t\t\t\tseparatorType=\"topFullWidth\"\n\t\t\t\t\tonPress={ onPress }\n\t\t\t\t\tlabelStyle={ actionButtonStyle }\n\t\t\t\t/>\n\t\t\t) ) }\n\t\t\t<TextControl\n\t\t\t\tlabel={ __( 'Dismiss' ) }\n\t\t\t\tseparatorType=\"topFullWidth\"\n\t\t\t\tonPress={ onCloseSheet }\n\t\t\t\tlabelStyle={ actionButtonStyle }\n\t\t\t/>\n\t\t</BottomSheet>\n\t);\n};\n\nexport default UnsupportedBlockDetails;\n"],"mappings":"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"}