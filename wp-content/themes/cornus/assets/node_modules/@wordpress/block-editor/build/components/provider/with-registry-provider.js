"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _react = require("react");
var _element = require("@wordpress/element");
var _data = require("@wordpress/data");
var _compose = require("@wordpress/compose");
var _store = require("../../store");
var _constants = require("../../store/constants");
/**
 * WordPress dependencies
 */

/**
 * Internal dependencies
 */

const withRegistryProvider = (0, _compose.createHigherOrderComponent)(WrappedComponent => {
  return (0, _data.withRegistry)(({
    useSubRegistry = true,
    registry,
    ...props
  }) => {
    if (!useSubRegistry) {
      return (0, _react.createElement)(WrappedComponent, {
        registry: registry,
        ...props
      });
    }
    const [subRegistry, setSubRegistry] = (0, _element.useState)(null);
    (0, _element.useEffect)(() => {
      const newRegistry = (0, _data.createRegistry)({}, registry);
      newRegistry.registerStore(_constants.STORE_NAME, _store.storeConfig);
      setSubRegistry(newRegistry);
    }, [registry]);
    if (!subRegistry) {
      return null;
    }
    return (0, _react.createElement)(_data.RegistryProvider, {
      value: subRegistry
    }, (0, _react.createElement)(WrappedComponent, {
      registry: subRegistry,
      ...props
    }));
  });
}, 'withRegistryProvider');
var _default = exports.default = withRegistryProvider;
//# sourceMappingURL=with-registry-provider.js.map