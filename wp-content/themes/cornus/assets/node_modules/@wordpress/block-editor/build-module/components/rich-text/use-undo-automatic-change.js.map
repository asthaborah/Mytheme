{"version":3,"names":["useSelect","useRefEffect","BACKSPACE","DELETE","ESCAPE","store","blockEditorStore","useUndoAutomaticChange","didAutomaticChange","getSettings","element","onKeyDown","event","keyCode","defaultPrevented","__experimentalUndo","preventDefault","addEventListener","removeEventListener"],"sources":["@wordpress/block-editor/src/components/rich-text/use-undo-automatic-change.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useSelect } from '@wordpress/data';\nimport { useRefEffect } from '@wordpress/compose';\nimport { BACKSPACE, DELETE, ESCAPE } from '@wordpress/keycodes';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../../store';\n\nexport function useUndoAutomaticChange() {\n\tconst { didAutomaticChange, getSettings } = useSelect( blockEditorStore );\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onKeyDown( event ) {\n\t\t\tconst { keyCode } = event;\n\n\t\t\tif ( event.defaultPrevented ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tkeyCode !== DELETE &&\n\t\t\t\tkeyCode !== BACKSPACE &&\n\t\t\t\tkeyCode !== ESCAPE\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { __experimentalUndo } = getSettings();\n\n\t\t\tif ( ! __experimentalUndo ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( ! didAutomaticChange() ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\t\t\t__experimentalUndo();\n\t\t}\n\n\t\telement.addEventListener( 'keydown', onKeyDown );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'keydown', onKeyDown );\n\t\t};\n\t}, [] );\n}\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,SAAS,QAAQ,iBAAiB;AAC3C,SAASC,YAAY,QAAQ,oBAAoB;AACjD,SAASC,SAAS,EAAEC,MAAM,EAAEC,MAAM,QAAQ,qBAAqB;;AAE/D;AACA;AACA;AACA,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,aAAa;AAEvD,OAAO,SAASC,sBAAsBA,CAAA,EAAG;EACxC,MAAM;IAAEC,kBAAkB;IAAEC;EAAY,CAAC,GAAGT,SAAS,CAAEM,gBAAiB,CAAC;EACzE,OAAOL,YAAY,CAAIS,OAAO,IAAM;IACnC,SAASC,SAASA,CAAEC,KAAK,EAAG;MAC3B,MAAM;QAAEC;MAAQ,CAAC,GAAGD,KAAK;MAEzB,IAAKA,KAAK,CAACE,gBAAgB,EAAG;QAC7B;MACD;MAEA,IACCD,OAAO,KAAKV,MAAM,IAClBU,OAAO,KAAKX,SAAS,IACrBW,OAAO,KAAKT,MAAM,EACjB;QACD;MACD;MAEA,MAAM;QAAEW;MAAmB,CAAC,GAAGN,WAAW,CAAC,CAAC;MAE5C,IAAK,CAAEM,kBAAkB,EAAG;QAC3B;MACD;MAEA,IAAK,CAAEP,kBAAkB,CAAC,CAAC,EAAG;QAC7B;MACD;MAEAI,KAAK,CAACI,cAAc,CAAC,CAAC;MACtBD,kBAAkB,CAAC,CAAC;IACrB;IAEAL,OAAO,CAACO,gBAAgB,CAAE,SAAS,EAAEN,SAAU,CAAC;IAChD,OAAO,MAAM;MACZD,OAAO,CAACQ,mBAAmB,CAAE,SAAS,EAAEP,SAAU,CAAC;IACpD,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;AACR"}