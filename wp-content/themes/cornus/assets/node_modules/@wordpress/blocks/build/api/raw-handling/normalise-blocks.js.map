{"version":3,"names":["_dom","require","normaliseBlocks","HTML","decuDoc","document","implementation","createHTMLDocument","accuDoc","decu","body","accu","innerHTML","firstChild","node","nodeType","TEXT_NODE","isEmpty","removeChild","lastChild","nodeName","appendChild","createElement","ELEMENT_NODE","nextSibling","hasChildNodes","isPhrasingContent"],"sources":["@wordpress/blocks/src/api/raw-handling/normalise-blocks.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { isEmpty, isPhrasingContent } from '@wordpress/dom';\n\nexport default function normaliseBlocks( HTML ) {\n\tconst decuDoc = document.implementation.createHTMLDocument( '' );\n\tconst accuDoc = document.implementation.createHTMLDocument( '' );\n\n\tconst decu = decuDoc.body;\n\tconst accu = accuDoc.body;\n\n\tdecu.innerHTML = HTML;\n\n\twhile ( decu.firstChild ) {\n\t\tconst node = decu.firstChild;\n\n\t\t// Text nodes: wrap in a paragraph, or append to previous.\n\t\tif ( node.nodeType === node.TEXT_NODE ) {\n\t\t\tif ( isEmpty( node ) ) {\n\t\t\t\tdecu.removeChild( node );\n\t\t\t} else {\n\t\t\t\tif ( ! accu.lastChild || accu.lastChild.nodeName !== 'P' ) {\n\t\t\t\t\taccu.appendChild( accuDoc.createElement( 'P' ) );\n\t\t\t\t}\n\n\t\t\t\taccu.lastChild.appendChild( node );\n\t\t\t}\n\t\t\t// Element nodes.\n\t\t} else if ( node.nodeType === node.ELEMENT_NODE ) {\n\t\t\t// BR nodes: create a new paragraph on double, or append to previous.\n\t\t\tif ( node.nodeName === 'BR' ) {\n\t\t\t\tif ( node.nextSibling && node.nextSibling.nodeName === 'BR' ) {\n\t\t\t\t\taccu.appendChild( accuDoc.createElement( 'P' ) );\n\t\t\t\t\tdecu.removeChild( node.nextSibling );\n\t\t\t\t}\n\n\t\t\t\t// Don't append to an empty paragraph.\n\t\t\t\tif (\n\t\t\t\t\taccu.lastChild &&\n\t\t\t\t\taccu.lastChild.nodeName === 'P' &&\n\t\t\t\t\taccu.lastChild.hasChildNodes()\n\t\t\t\t) {\n\t\t\t\t\taccu.lastChild.appendChild( node );\n\t\t\t\t} else {\n\t\t\t\t\tdecu.removeChild( node );\n\t\t\t\t}\n\t\t\t} else if ( node.nodeName === 'P' ) {\n\t\t\t\t// Only append non-empty paragraph nodes.\n\t\t\t\tif ( isEmpty( node ) ) {\n\t\t\t\t\tdecu.removeChild( node );\n\t\t\t\t} else {\n\t\t\t\t\taccu.appendChild( node );\n\t\t\t\t}\n\t\t\t} else if ( isPhrasingContent( node ) ) {\n\t\t\t\tif ( ! accu.lastChild || accu.lastChild.nodeName !== 'P' ) {\n\t\t\t\t\taccu.appendChild( accuDoc.createElement( 'P' ) );\n\t\t\t\t}\n\t\t\t\taccu.lastChild.appendChild( node );\n\t\t\t} else {\n\t\t\t\taccu.appendChild( node );\n\t\t\t}\n\t\t} else {\n\t\t\tdecu.removeChild( node );\n\t\t}\n\t}\n\n\treturn accu.innerHTML;\n}\n"],"mappings":";;;;;;AAGA,IAAAA,IAAA,GAAAC,OAAA;AAHA;AACA;AACA;;AAGe,SAASC,eAAeA,CAAEC,IAAI,EAAG;EAC/C,MAAMC,OAAO,GAAGC,QAAQ,CAACC,cAAc,CAACC,kBAAkB,CAAE,EAAG,CAAC;EAChE,MAAMC,OAAO,GAAGH,QAAQ,CAACC,cAAc,CAACC,kBAAkB,CAAE,EAAG,CAAC;EAEhE,MAAME,IAAI,GAAGL,OAAO,CAACM,IAAI;EACzB,MAAMC,IAAI,GAAGH,OAAO,CAACE,IAAI;EAEzBD,IAAI,CAACG,SAAS,GAAGT,IAAI;EAErB,OAAQM,IAAI,CAACI,UAAU,EAAG;IACzB,MAAMC,IAAI,GAAGL,IAAI,CAACI,UAAU;;IAE5B;IACA,IAAKC,IAAI,CAACC,QAAQ,KAAKD,IAAI,CAACE,SAAS,EAAG;MACvC,IAAK,IAAAC,YAAO,EAAEH,IAAK,CAAC,EAAG;QACtBL,IAAI,CAACS,WAAW,CAAEJ,IAAK,CAAC;MACzB,CAAC,MAAM;QACN,IAAK,CAAEH,IAAI,CAACQ,SAAS,IAAIR,IAAI,CAACQ,SAAS,CAACC,QAAQ,KAAK,GAAG,EAAG;UAC1DT,IAAI,CAACU,WAAW,CAAEb,OAAO,CAACc,aAAa,CAAE,GAAI,CAAE,CAAC;QACjD;QAEAX,IAAI,CAACQ,SAAS,CAACE,WAAW,CAAEP,IAAK,CAAC;MACnC;MACA;IACD,CAAC,MAAM,IAAKA,IAAI,CAACC,QAAQ,KAAKD,IAAI,CAACS,YAAY,EAAG;MACjD;MACA,IAAKT,IAAI,CAACM,QAAQ,KAAK,IAAI,EAAG;QAC7B,IAAKN,IAAI,CAACU,WAAW,IAAIV,IAAI,CAACU,WAAW,CAACJ,QAAQ,KAAK,IAAI,EAAG;UAC7DT,IAAI,CAACU,WAAW,CAAEb,OAAO,CAACc,aAAa,CAAE,GAAI,CAAE,CAAC;UAChDb,IAAI,CAACS,WAAW,CAAEJ,IAAI,CAACU,WAAY,CAAC;QACrC;;QAEA;QACA,IACCb,IAAI,CAACQ,SAAS,IACdR,IAAI,CAACQ,SAAS,CAACC,QAAQ,KAAK,GAAG,IAC/BT,IAAI,CAACQ,SAAS,CAACM,aAAa,CAAC,CAAC,EAC7B;UACDd,IAAI,CAACQ,SAAS,CAACE,WAAW,CAAEP,IAAK,CAAC;QACnC,CAAC,MAAM;UACNL,IAAI,CAACS,WAAW,CAAEJ,IAAK,CAAC;QACzB;MACD,CAAC,MAAM,IAAKA,IAAI,CAACM,QAAQ,KAAK,GAAG,EAAG;QACnC;QACA,IAAK,IAAAH,YAAO,EAAEH,IAAK,CAAC,EAAG;UACtBL,IAAI,CAACS,WAAW,CAAEJ,IAAK,CAAC;QACzB,CAAC,MAAM;UACNH,IAAI,CAACU,WAAW,CAAEP,IAAK,CAAC;QACzB;MACD,CAAC,MAAM,IAAK,IAAAY,sBAAiB,EAAEZ,IAAK,CAAC,EAAG;QACvC,IAAK,CAAEH,IAAI,CAACQ,SAAS,IAAIR,IAAI,CAACQ,SAAS,CAACC,QAAQ,KAAK,GAAG,EAAG;UAC1DT,IAAI,CAACU,WAAW,CAAEb,OAAO,CAACc,aAAa,CAAE,GAAI,CAAE,CAAC;QACjD;QACAX,IAAI,CAACQ,SAAS,CAACE,WAAW,CAAEP,IAAK,CAAC;MACnC,CAAC,MAAM;QACNH,IAAI,CAACU,WAAW,CAAEP,IAAK,CAAC;MACzB;IACD,CAAC,MAAM;MACNL,IAAI,CAACS,WAAW,CAAEJ,IAAK,CAAC;IACzB;EACD;EAEA,OAAOH,IAAI,CAACC,SAAS;AACtB"}