{"version":3,"names":["forwardRef","deprecated","useDispatch","RichTextWrapper","store","blockEditorStore","useBlockEditContext","getMultilineTag","RichTextMultiline","children","identifier","tagName","TagName","value","onChange","multiline","props","forwardedRef","since","version","alternative","link","clientId","selectionChange","multilineTagName","padded","values","split","shift","pop","_onChange","newValues","join","createElement","ref","map","_value","index","key","newValue","slice","isSelected","undefined","onSplit","v","onReplace","array","splice","onMerge","forward","offset","length"],"sources":["@wordpress/block-editor/src/components/rich-text/multiline.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { forwardRef } from '@wordpress/element';\nimport deprecated from '@wordpress/deprecated';\nimport { useDispatch } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport { RichTextWrapper } from './';\nimport { store as blockEditorStore } from '../../store';\nimport { useBlockEditContext } from '../block-edit';\nimport { getMultilineTag } from './utils';\n\nfunction RichTextMultiline(\n\t{\n\t\tchildren,\n\t\tidentifier,\n\t\ttagName: TagName = 'div',\n\t\tvalue = '',\n\t\tonChange,\n\t\tmultiline,\n\t\t...props\n\t},\n\tforwardedRef\n) {\n\tdeprecated( 'wp.blockEditor.RichText multiline prop', {\n\t\tsince: '6.1',\n\t\tversion: '6.3',\n\t\talternative: 'nested blocks (InnerBlocks)',\n\t\tlink: 'https://developer.wordpress.org/block-editor/how-to-guides/block-tutorial/nested-blocks-inner-blocks/',\n\t} );\n\n\tconst { clientId } = useBlockEditContext();\n\tconst { selectionChange } = useDispatch( blockEditorStore );\n\n\tconst multilineTagName = getMultilineTag( multiline );\n\tvalue = value || `<${ multilineTagName }></${ multilineTagName }>`;\n\tconst padded = `</${ multilineTagName }>${ value }<${ multilineTagName }>`;\n\tconst values = padded.split(\n\t\t`</${ multilineTagName }><${ multilineTagName }>`\n\t);\n\n\tvalues.shift();\n\tvalues.pop();\n\n\tfunction _onChange( newValues ) {\n\t\tonChange(\n\t\t\t`<${ multilineTagName }>${ newValues.join(\n\t\t\t\t`</${ multilineTagName }><${ multilineTagName }>`\n\t\t\t) }</${ multilineTagName }>`\n\t\t);\n\t}\n\n\treturn (\n\t\t<TagName ref={ forwardedRef }>\n\t\t\t{ values.map( ( _value, index ) => {\n\t\t\t\treturn (\n\t\t\t\t\t<RichTextWrapper\n\t\t\t\t\t\tkey={ index }\n\t\t\t\t\t\tidentifier={ `${ identifier }-${ index }` }\n\t\t\t\t\t\ttagName={ multilineTagName }\n\t\t\t\t\t\tvalue={ _value }\n\t\t\t\t\t\tonChange={ ( newValue ) => {\n\t\t\t\t\t\t\tconst newValues = values.slice();\n\t\t\t\t\t\t\tnewValues[ index ] = newValue;\n\t\t\t\t\t\t\t_onChange( newValues );\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tisSelected={ undefined }\n\t\t\t\t\t\tonSplit={ ( v ) => v }\n\t\t\t\t\t\tonReplace={ ( array ) => {\n\t\t\t\t\t\t\tconst newValues = values.slice();\n\t\t\t\t\t\t\tnewValues.splice( index, 1, ...array );\n\t\t\t\t\t\t\t_onChange( newValues );\n\t\t\t\t\t\t\tselectionChange(\n\t\t\t\t\t\t\t\tclientId,\n\t\t\t\t\t\t\t\t`${ identifier }-${ index + 1 }`,\n\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\t0\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} }\n\t\t\t\t\t\tonMerge={ ( forward ) => {\n\t\t\t\t\t\t\tconst newValues = values.slice();\n\t\t\t\t\t\t\tlet offset = 0;\n\t\t\t\t\t\t\tif ( forward ) {\n\t\t\t\t\t\t\t\tif ( ! newValues[ index + 1 ] ) return;\n\t\t\t\t\t\t\t\tnewValues.splice(\n\t\t\t\t\t\t\t\t\tindex,\n\t\t\t\t\t\t\t\t\t2,\n\t\t\t\t\t\t\t\t\tnewValues[ index ] + newValues[ index + 1 ]\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\toffset = newValues[ index ].length - 1;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif ( ! newValues[ index - 1 ] ) return;\n\t\t\t\t\t\t\t\tnewValues.splice(\n\t\t\t\t\t\t\t\t\tindex - 1,\n\t\t\t\t\t\t\t\t\t2,\n\t\t\t\t\t\t\t\t\tnewValues[ index - 1 ] + newValues[ index ]\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\toffset = newValues[ index - 1 ].length - 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t_onChange( newValues );\n\t\t\t\t\t\t\tselectionChange(\n\t\t\t\t\t\t\t\tclientId,\n\t\t\t\t\t\t\t\t`${ identifier }-${\n\t\t\t\t\t\t\t\t\tindex - ( forward ? 0 : 1 )\n\t\t\t\t\t\t\t\t}`,\n\t\t\t\t\t\t\t\toffset,\n\t\t\t\t\t\t\t\toffset\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} }\n\t\t\t\t\t\t{ ...props }\n\t\t\t\t\t/>\n\t\t\t\t);\n\t\t\t} ) }\n\t\t</TagName>\n\t);\n}\n\nexport default forwardRef( RichTextMultiline );\n"],"mappings":"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"}