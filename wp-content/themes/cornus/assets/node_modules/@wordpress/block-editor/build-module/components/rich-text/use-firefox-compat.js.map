{"version":3,"names":["useRefEffect","useSelect","store","blockEditorStore","useFirefoxCompat","isMultiSelecting","element","onFocus","parentEditable","parentElement","closest","focus","addEventListener","removeEventListener"],"sources":["@wordpress/block-editor/src/components/rich-text/use-firefox-compat.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { useRefEffect } from '@wordpress/compose';\nimport { useSelect } from '@wordpress/data';\n\n/**\n * Internal dependencies\n */\nimport { store as blockEditorStore } from '../../store';\n\nexport function useFirefoxCompat() {\n\tconst { isMultiSelecting } = useSelect( blockEditorStore );\n\treturn useRefEffect( ( element ) => {\n\t\tfunction onFocus() {\n\t\t\tif ( ! isMultiSelecting() ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// This is a little hack to work around focus issues with nested\n\t\t\t// editable elements in Firefox. For some reason the editable child\n\t\t\t// element sometimes regains focus, while it should not be focusable\n\t\t\t// and focus should remain on the editable parent element.\n\t\t\t// To do: try to find the cause of the shifting focus.\n\t\t\tconst parentEditable = element.parentElement.closest(\n\t\t\t\t'[contenteditable=\"true\"]'\n\t\t\t);\n\n\t\t\tif ( parentEditable ) {\n\t\t\t\tparentEditable.focus();\n\t\t\t}\n\t\t}\n\n\t\telement.addEventListener( 'focus', onFocus );\n\t\treturn () => {\n\t\t\telement.removeEventListener( 'focus', onFocus );\n\t\t};\n\t}, [] );\n}\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,YAAY,QAAQ,oBAAoB;AACjD,SAASC,SAAS,QAAQ,iBAAiB;;AAE3C;AACA;AACA;AACA,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,aAAa;AAEvD,OAAO,SAASC,gBAAgBA,CAAA,EAAG;EAClC,MAAM;IAAEC;EAAiB,CAAC,GAAGJ,SAAS,CAAEE,gBAAiB,CAAC;EAC1D,OAAOH,YAAY,CAAIM,OAAO,IAAM;IACnC,SAASC,OAAOA,CAAA,EAAG;MAClB,IAAK,CAAEF,gBAAgB,CAAC,CAAC,EAAG;QAC3B;MACD;;MAEA;MACA;MACA;MACA;MACA;MACA,MAAMG,cAAc,GAAGF,OAAO,CAACG,aAAa,CAACC,OAAO,CACnD,0BACD,CAAC;MAED,IAAKF,cAAc,EAAG;QACrBA,cAAc,CAACG,KAAK,CAAC,CAAC;MACvB;IACD;IAEAL,OAAO,CAACM,gBAAgB,CAAE,OAAO,EAAEL,OAAQ,CAAC;IAC5C,OAAO,MAAM;MACZD,OAAO,CAACO,mBAAmB,CAAE,OAAO,EAAEN,OAAQ,CAAC;IAChD,CAAC;EACF,CAAC,EAAE,EAAG,CAAC;AACR"}