{"version":3,"names":["__","sprintf","useEffect","useState","Button","CheckboxControl","Flex","FlexItem","Icon","Modal","ToggleControl","lock","lockIcon","unlock","unlockIcon","useInstanceId","useDispatch","useSelect","getBlockType","useBlockLock","useBlockDisplayInformation","store","blockEditorStore","ALLOWS_EDIT_LOCKING","getTemplateLockValue","remove","move","BlockLockModal","clientId","onClose","setLock","canEdit","canMove","canRemove","allowsEditLocking","templateLock","hasTemplateLock","select","getBlockName","getBlockAttributes","blockName","blockType","includes","attributes","applyTemplateLock","setApplyTemplateLock","updateBlockAttributes","blockInformation","instanceId","edit","isAllChecked","Object","values","every","Boolean","isMixed","some","createElement","title","overlayClassName","onRequestClose","onSubmit","event","preventDefault","undefined","role","className","__nextHasNoMarginBottom","label","id","checked","indeterminate","onChange","newValue","prevLock","icon","disabled","justify","expanded","variant","onClick","type"],"sources":["@wordpress/block-editor/src/components/block-lock/modal.js"],"sourcesContent":["/**\n * WordPress dependencies\n */\nimport { __, sprintf } from '@wordpress/i18n';\nimport { useEffect, useState } from '@wordpress/element';\nimport {\n\tButton,\n\tCheckboxControl,\n\tFlex,\n\tFlexItem,\n\tIcon,\n\tModal,\n\tToggleControl,\n} from '@wordpress/components';\nimport { lock as lockIcon, unlock as unlockIcon } from '@wordpress/icons';\nimport { useInstanceId } from '@wordpress/compose';\nimport { useDispatch, useSelect } from '@wordpress/data';\nimport { getBlockType } from '@wordpress/blocks';\n\n/**\n * Internal dependencies\n */\nimport useBlockLock from './use-block-lock';\nimport useBlockDisplayInformation from '../use-block-display-information';\nimport { store as blockEditorStore } from '../../store';\n\n// Entity based blocks which allow edit locking\nconst ALLOWS_EDIT_LOCKING = [ 'core/block', 'core/navigation' ];\n\nfunction getTemplateLockValue( lock ) {\n\t// Prevents all operations.\n\tif ( lock.remove && lock.move ) {\n\t\treturn 'all';\n\t}\n\n\t// Prevents inserting or removing blocks, but allows moving existing blocks.\n\tif ( lock.remove && ! lock.move ) {\n\t\treturn 'insert';\n\t}\n\n\treturn false;\n}\n\nexport default function BlockLockModal( { clientId, onClose } ) {\n\tconst [ lock, setLock ] = useState( { move: false, remove: false } );\n\tconst { canEdit, canMove, canRemove } = useBlockLock( clientId );\n\tconst { allowsEditLocking, templateLock, hasTemplateLock } = useSelect(\n\t\t( select ) => {\n\t\t\tconst { getBlockName, getBlockAttributes } =\n\t\t\t\tselect( blockEditorStore );\n\t\t\tconst blockName = getBlockName( clientId );\n\t\t\tconst blockType = getBlockType( blockName );\n\n\t\t\treturn {\n\t\t\t\tallowsEditLocking: ALLOWS_EDIT_LOCKING.includes( blockName ),\n\t\t\t\ttemplateLock: getBlockAttributes( clientId )?.templateLock,\n\t\t\t\thasTemplateLock: !! blockType?.attributes?.templateLock,\n\t\t\t};\n\t\t},\n\t\t[ clientId ]\n\t);\n\tconst [ applyTemplateLock, setApplyTemplateLock ] = useState(\n\t\t!! templateLock\n\t);\n\tconst { updateBlockAttributes } = useDispatch( blockEditorStore );\n\tconst blockInformation = useBlockDisplayInformation( clientId );\n\tconst instanceId = useInstanceId(\n\t\tBlockLockModal,\n\t\t'block-editor-block-lock-modal__options-title'\n\t);\n\n\tuseEffect( () => {\n\t\tsetLock( {\n\t\t\tmove: ! canMove,\n\t\t\tremove: ! canRemove,\n\t\t\t...( allowsEditLocking ? { edit: ! canEdit } : {} ),\n\t\t} );\n\t}, [ canEdit, canMove, canRemove, allowsEditLocking ] );\n\n\tconst isAllChecked = Object.values( lock ).every( Boolean );\n\tconst isMixed = Object.values( lock ).some( Boolean ) && ! isAllChecked;\n\n\treturn (\n\t\t<Modal\n\t\t\ttitle={ sprintf(\n\t\t\t\t/* translators: %s: Name of the block. */\n\t\t\t\t__( 'Lock %s' ),\n\t\t\t\tblockInformation.title\n\t\t\t) }\n\t\t\toverlayClassName=\"block-editor-block-lock-modal\"\n\t\t\tonRequestClose={ onClose }\n\t\t>\n\t\t\t<p>\n\t\t\t\t{ __(\n\t\t\t\t\t'Choose specific attributes to restrict or lock all available options.'\n\t\t\t\t) }\n\t\t\t</p>\n\t\t\t<form\n\t\t\t\tonSubmit={ ( event ) => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tupdateBlockAttributes( [ clientId ], {\n\t\t\t\t\t\tlock,\n\t\t\t\t\t\ttemplateLock: applyTemplateLock\n\t\t\t\t\t\t\t? getTemplateLockValue( lock )\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t} );\n\t\t\t\t\tonClose();\n\t\t\t\t} }\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\trole=\"group\"\n\t\t\t\t\taria-labelledby={ instanceId }\n\t\t\t\t\tclassName=\"block-editor-block-lock-modal__options\"\n\t\t\t\t>\n\t\t\t\t\t<CheckboxControl\n\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\tclassName=\"block-editor-block-lock-modal__options-title\"\n\t\t\t\t\t\tlabel={\n\t\t\t\t\t\t\t<span id={ instanceId }>{ __( 'Lock all' ) }</span>\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchecked={ isAllChecked }\n\t\t\t\t\t\tindeterminate={ isMixed }\n\t\t\t\t\t\tonChange={ ( newValue ) =>\n\t\t\t\t\t\t\tsetLock( {\n\t\t\t\t\t\t\t\tmove: newValue,\n\t\t\t\t\t\t\t\tremove: newValue,\n\t\t\t\t\t\t\t\t...( allowsEditLocking\n\t\t\t\t\t\t\t\t\t? { edit: newValue }\n\t\t\t\t\t\t\t\t\t: {} ),\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t\t<ul className=\"block-editor-block-lock-modal__checklist\">\n\t\t\t\t\t\t{ allowsEditLocking && (\n\t\t\t\t\t\t\t<li className=\"block-editor-block-lock-modal__checklist-item\">\n\t\t\t\t\t\t\t\t<CheckboxControl\n\t\t\t\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\t\t\t\tlabel={ __( 'Restrict editing' ) }\n\t\t\t\t\t\t\t\t\tchecked={ !! lock.edit }\n\t\t\t\t\t\t\t\t\tonChange={ ( edit ) =>\n\t\t\t\t\t\t\t\t\t\tsetLock( ( prevLock ) => ( {\n\t\t\t\t\t\t\t\t\t\t\t...prevLock,\n\t\t\t\t\t\t\t\t\t\t\tedit,\n\t\t\t\t\t\t\t\t\t\t} ) )\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\t\tclassName=\"block-editor-block-lock-modal__lock-icon\"\n\t\t\t\t\t\t\t\t\ticon={ lock.edit ? lockIcon : unlockIcon }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t) }\n\t\t\t\t\t\t<li className=\"block-editor-block-lock-modal__checklist-item\">\n\t\t\t\t\t\t\t<CheckboxControl\n\t\t\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\t\t\tlabel={ __( 'Disable movement' ) }\n\t\t\t\t\t\t\t\tchecked={ lock.move }\n\t\t\t\t\t\t\t\tonChange={ ( move ) =>\n\t\t\t\t\t\t\t\t\tsetLock( ( prevLock ) => ( {\n\t\t\t\t\t\t\t\t\t\t...prevLock,\n\t\t\t\t\t\t\t\t\t\tmove,\n\t\t\t\t\t\t\t\t\t} ) )\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\tclassName=\"block-editor-block-lock-modal__lock-icon\"\n\t\t\t\t\t\t\t\ticon={ lock.move ? lockIcon : unlockIcon }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<li className=\"block-editor-block-lock-modal__checklist-item\">\n\t\t\t\t\t\t\t<CheckboxControl\n\t\t\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\t\t\tlabel={ __( 'Prevent removal' ) }\n\t\t\t\t\t\t\t\tchecked={ lock.remove }\n\t\t\t\t\t\t\t\tonChange={ ( remove ) =>\n\t\t\t\t\t\t\t\t\tsetLock( ( prevLock ) => ( {\n\t\t\t\t\t\t\t\t\t\t...prevLock,\n\t\t\t\t\t\t\t\t\t\tremove,\n\t\t\t\t\t\t\t\t\t} ) )\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\tclassName=\"block-editor-block-lock-modal__lock-icon\"\n\t\t\t\t\t\t\t\ticon={ lock.remove ? lockIcon : unlockIcon }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t\t{ hasTemplateLock && (\n\t\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\t\t__nextHasNoMarginBottom\n\t\t\t\t\t\t\tclassName=\"block-editor-block-lock-modal__template-lock\"\n\t\t\t\t\t\t\tlabel={ __( 'Apply to all blocks inside' ) }\n\t\t\t\t\t\t\tchecked={ applyTemplateLock }\n\t\t\t\t\t\t\tdisabled={ lock.move && ! lock.remove }\n\t\t\t\t\t\t\tonChange={ () =>\n\t\t\t\t\t\t\t\tsetApplyTemplateLock( ! applyTemplateLock )\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</div>\n\t\t\t\t<Flex\n\t\t\t\t\tclassName=\"block-editor-block-lock-modal__actions\"\n\t\t\t\t\tjustify=\"flex-end\"\n\t\t\t\t\texpanded={ false }\n\t\t\t\t>\n\t\t\t\t\t<FlexItem>\n\t\t\t\t\t\t<Button variant=\"tertiary\" onClick={ onClose }>\n\t\t\t\t\t\t\t{ __( 'Cancel' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</FlexItem>\n\t\t\t\t\t<FlexItem>\n\t\t\t\t\t\t<Button variant=\"primary\" type=\"submit\">\n\t\t\t\t\t\t\t{ __( 'Apply' ) }\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</FlexItem>\n\t\t\t\t</Flex>\n\t\t\t</form>\n\t\t</Modal>\n\t);\n}\n"],"mappings":"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"}