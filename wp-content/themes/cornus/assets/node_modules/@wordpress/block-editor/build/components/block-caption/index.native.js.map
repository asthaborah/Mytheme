{"version":3,"names":["_reactNative","require","_blockEditor","_compose","_data","_blocks","_styles","_interopRequireDefault","_store","BlockCaption","accessible","accessibilityLabelCreator","onBlur","onChange","onFocus","isSelected","shouldDisplay","text","insertBlocksAfter","_react","createElement","View","style","styles","container","padding","Caption","value","_default","exports","default","compose","withSelect","select","clientId","getBlockAttributes","getSelectedBlockClientId","getBlockName","getBlockRootClientId","blockEditorStore","caption","isBlockSelected","parentId","parentBlockName","hideCaption","hasBlockSupport","RichText","isEmpty","withDispatch","dispatch","updateBlockAttributes"],"sources":["@wordpress/block-editor/src/components/block-caption/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { View } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { Caption, RichText } from '@wordpress/block-editor';\nimport { compose } from '@wordpress/compose';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { hasBlockSupport } from '@wordpress/blocks';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\nimport { store as blockEditorStore } from '../../store';\n\nconst BlockCaption = ( {\n\taccessible,\n\taccessibilityLabelCreator,\n\tonBlur,\n\tonChange,\n\tonFocus,\n\tisSelected,\n\tshouldDisplay,\n\ttext,\n\tinsertBlocksAfter,\n} ) => (\n\t<View style={ [ styles.container, shouldDisplay && styles.padding ] }>\n\t\t<Caption\n\t\t\taccessibilityLabelCreator={ accessibilityLabelCreator }\n\t\t\taccessible={ accessible }\n\t\t\tisSelected={ isSelected }\n\t\t\tonBlur={ onBlur }\n\t\t\tonChange={ onChange }\n\t\t\tonFocus={ onFocus }\n\t\t\tshouldDisplay={ shouldDisplay }\n\t\t\tvalue={ text }\n\t\t\tinsertBlocksAfter={ insertBlocksAfter }\n\t\t/>\n\t</View>\n);\n\nexport default compose( [\n\twithSelect( ( select, { clientId } ) => {\n\t\tconst {\n\t\t\tgetBlockAttributes,\n\t\t\tgetSelectedBlockClientId,\n\t\t\tgetBlockName,\n\t\t\tgetBlockRootClientId,\n\t\t} = select( blockEditorStore );\n\t\tconst { caption } = getBlockAttributes( clientId ) || {};\n\t\tconst isBlockSelected = getSelectedBlockClientId() === clientId;\n\n\t\t// Detect whether the block is an inner block by checking if it has a parent block.\n\t\t// getBlockRootClientId() will return an empty string for all top-level blocks.\n\t\t// If the block is an inner block, its parent may explicitly hide child block controls.\n\t\t// See: https://github.com/wordpress-mobile/gutenberg-mobile/pull/4256\n\t\tconst parentId = getBlockRootClientId( clientId );\n\t\tconst parentBlockName = getBlockName( parentId );\n\n\t\tconst hideCaption = hasBlockSupport(\n\t\t\tparentBlockName,\n\t\t\t'__experimentalHideChildBlockControls',\n\t\t\tfalse\n\t\t);\n\n\t\t// We'll render the caption so that the soft keyboard is not forced to close on Android\n\t\t// but still hide it by setting its display style to none. See wordpress-mobile/gutenberg-mobile#1221\n\t\tconst shouldDisplay =\n\t\t\t! hideCaption &&\n\t\t\t( ! RichText.isEmpty( caption ) > 0 || isBlockSelected );\n\n\t\treturn {\n\t\t\tshouldDisplay,\n\t\t\ttext: caption,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { clientId } ) => {\n\t\tconst { updateBlockAttributes } = dispatch( blockEditorStore );\n\t\treturn {\n\t\t\tonChange: ( caption ) => {\n\t\t\t\tupdateBlockAttributes( clientId, { caption } );\n\t\t\t},\n\t\t};\n\t} ),\n] )( BlockCaption );\n"],"mappings":";;;;;;;;AAGA,IAAAA,YAAA,GAAAC,OAAA;AAKA,IAAAC,YAAA,GAAAD,OAAA;AACA,IAAAE,QAAA,GAAAF,OAAA;AACA,IAAAG,KAAA,GAAAH,OAAA;AACA,IAAAI,OAAA,GAAAJ,OAAA;AAKA,IAAAK,OAAA,GAAAC,sBAAA,CAAAN,OAAA;AACA,IAAAO,MAAA,GAAAP,OAAA;AAjBA;AACA;AACA;;AAGA;AACA;AACA;;AAMA;AACA;AACA;;AAIA,MAAMQ,YAAY,GAAGA,CAAE;EACtBC,UAAU;EACVC,yBAAyB;EACzBC,MAAM;EACNC,QAAQ;EACRC,OAAO;EACPC,UAAU;EACVC,aAAa;EACbC,IAAI;EACJC;AACD,CAAC,KACA,IAAAC,MAAA,CAAAC,aAAA,EAACpB,YAAA,CAAAqB,IAAI;EAACC,KAAK,EAAG,CAAEC,eAAM,CAACC,SAAS,EAAER,aAAa,IAAIO,eAAM,CAACE,OAAO;AAAI,GACpE,IAAAN,MAAA,CAAAC,aAAA,EAAClB,YAAA,CAAAwB,OAAO;EACPf,yBAAyB,EAAGA,yBAA2B;EACvDD,UAAU,EAAGA,UAAY;EACzBK,UAAU,EAAGA,UAAY;EACzBH,MAAM,EAAGA,MAAQ;EACjBC,QAAQ,EAAGA,QAAU;EACrBC,OAAO,EAAGA,OAAS;EACnBE,aAAa,EAAGA,aAAe;EAC/BW,KAAK,EAAGV,IAAM;EACdC,iBAAiB,EAAGA;AAAmB,CACvC,CACI,CACN;AAAC,IAAAU,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEa,IAAAC,gBAAO,EAAE,CACvB,IAAAC,gBAAU,EAAE,CAAEC,MAAM,EAAE;EAAEC;AAAS,CAAC,KAAM;EACvC,MAAM;IACLC,kBAAkB;IAClBC,wBAAwB;IACxBC,YAAY;IACZC;EACD,CAAC,GAAGL,MAAM,CAAEM,YAAiB,CAAC;EAC9B,MAAM;IAAEC;EAAQ,CAAC,GAAGL,kBAAkB,CAAED,QAAS,CAAC,IAAI,CAAC,CAAC;EACxD,MAAMO,eAAe,GAAGL,wBAAwB,CAAC,CAAC,KAAKF,QAAQ;;EAE/D;EACA;EACA;EACA;EACA,MAAMQ,QAAQ,GAAGJ,oBAAoB,CAAEJ,QAAS,CAAC;EACjD,MAAMS,eAAe,GAAGN,YAAY,CAAEK,QAAS,CAAC;EAEhD,MAAME,WAAW,GAAG,IAAAC,uBAAe,EAClCF,eAAe,EACf,sCAAsC,EACtC,KACD,CAAC;;EAED;EACA;EACA,MAAM3B,aAAa,GAClB,CAAE4B,WAAW,KACX,CAAEE,qBAAQ,CAACC,OAAO,CAAEP,OAAQ,CAAC,GAAG,CAAC,IAAIC,eAAe,CAAE;EAEzD,OAAO;IACNzB,aAAa;IACbC,IAAI,EAAEuB;EACP,CAAC;AACF,CAAE,CAAC,EACH,IAAAQ,kBAAY,EAAE,CAAEC,QAAQ,EAAE;EAAEf;AAAS,CAAC,KAAM;EAC3C,MAAM;IAAEgB;EAAsB,CAAC,GAAGD,QAAQ,CAAEV,YAAiB,CAAC;EAC9D,OAAO;IACN1B,QAAQ,EAAI2B,OAAO,IAAM;MACxBU,qBAAqB,CAAEhB,QAAQ,EAAE;QAAEM;MAAQ,CAAE,CAAC;IAC/C;EACD,CAAC;AACF,CAAE,CAAC,CACF,CAAC,CAAE/B,YAAa,CAAC"}