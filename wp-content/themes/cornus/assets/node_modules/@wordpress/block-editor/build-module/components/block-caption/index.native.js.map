{"version":3,"names":["View","Caption","RichText","compose","withDispatch","withSelect","hasBlockSupport","styles","store","blockEditorStore","BlockCaption","accessible","accessibilityLabelCreator","onBlur","onChange","onFocus","isSelected","shouldDisplay","text","insertBlocksAfter","createElement","style","container","padding","value","select","clientId","getBlockAttributes","getSelectedBlockClientId","getBlockName","getBlockRootClientId","caption","isBlockSelected","parentId","parentBlockName","hideCaption","isEmpty","dispatch","updateBlockAttributes"],"sources":["@wordpress/block-editor/src/components/block-caption/index.native.js"],"sourcesContent":["/**\n * External dependencies\n */\nimport { View } from 'react-native';\n\n/**\n * WordPress dependencies\n */\nimport { Caption, RichText } from '@wordpress/block-editor';\nimport { compose } from '@wordpress/compose';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { hasBlockSupport } from '@wordpress/blocks';\n\n/**\n * Internal dependencies\n */\nimport styles from './styles.scss';\nimport { store as blockEditorStore } from '../../store';\n\nconst BlockCaption = ( {\n\taccessible,\n\taccessibilityLabelCreator,\n\tonBlur,\n\tonChange,\n\tonFocus,\n\tisSelected,\n\tshouldDisplay,\n\ttext,\n\tinsertBlocksAfter,\n} ) => (\n\t<View style={ [ styles.container, shouldDisplay && styles.padding ] }>\n\t\t<Caption\n\t\t\taccessibilityLabelCreator={ accessibilityLabelCreator }\n\t\t\taccessible={ accessible }\n\t\t\tisSelected={ isSelected }\n\t\t\tonBlur={ onBlur }\n\t\t\tonChange={ onChange }\n\t\t\tonFocus={ onFocus }\n\t\t\tshouldDisplay={ shouldDisplay }\n\t\t\tvalue={ text }\n\t\t\tinsertBlocksAfter={ insertBlocksAfter }\n\t\t/>\n\t</View>\n);\n\nexport default compose( [\n\twithSelect( ( select, { clientId } ) => {\n\t\tconst {\n\t\t\tgetBlockAttributes,\n\t\t\tgetSelectedBlockClientId,\n\t\t\tgetBlockName,\n\t\t\tgetBlockRootClientId,\n\t\t} = select( blockEditorStore );\n\t\tconst { caption } = getBlockAttributes( clientId ) || {};\n\t\tconst isBlockSelected = getSelectedBlockClientId() === clientId;\n\n\t\t// Detect whether the block is an inner block by checking if it has a parent block.\n\t\t// getBlockRootClientId() will return an empty string for all top-level blocks.\n\t\t// If the block is an inner block, its parent may explicitly hide child block controls.\n\t\t// See: https://github.com/wordpress-mobile/gutenberg-mobile/pull/4256\n\t\tconst parentId = getBlockRootClientId( clientId );\n\t\tconst parentBlockName = getBlockName( parentId );\n\n\t\tconst hideCaption = hasBlockSupport(\n\t\t\tparentBlockName,\n\t\t\t'__experimentalHideChildBlockControls',\n\t\t\tfalse\n\t\t);\n\n\t\t// We'll render the caption so that the soft keyboard is not forced to close on Android\n\t\t// but still hide it by setting its display style to none. See wordpress-mobile/gutenberg-mobile#1221\n\t\tconst shouldDisplay =\n\t\t\t! hideCaption &&\n\t\t\t( ! RichText.isEmpty( caption ) > 0 || isBlockSelected );\n\n\t\treturn {\n\t\t\tshouldDisplay,\n\t\t\ttext: caption,\n\t\t};\n\t} ),\n\twithDispatch( ( dispatch, { clientId } ) => {\n\t\tconst { updateBlockAttributes } = dispatch( blockEditorStore );\n\t\treturn {\n\t\t\tonChange: ( caption ) => {\n\t\t\t\tupdateBlockAttributes( clientId, { caption } );\n\t\t\t},\n\t\t};\n\t} ),\n] )( BlockCaption );\n"],"mappings":";AAAA;AACA;AACA;AACA,SAASA,IAAI,QAAQ,cAAc;;AAEnC;AACA;AACA;AACA,SAASC,OAAO,EAAEC,QAAQ,QAAQ,yBAAyB;AAC3D,SAASC,OAAO,QAAQ,oBAAoB;AAC5C,SAASC,YAAY,EAAEC,UAAU,QAAQ,iBAAiB;AAC1D,SAASC,eAAe,QAAQ,mBAAmB;;AAEnD;AACA;AACA;AACA,OAAOC,MAAM,MAAM,eAAe;AAClC,SAASC,KAAK,IAAIC,gBAAgB,QAAQ,aAAa;AAEvD,MAAMC,YAAY,GAAGA,CAAE;EACtBC,UAAU;EACVC,yBAAyB;EACzBC,MAAM;EACNC,QAAQ;EACRC,OAAO;EACPC,UAAU;EACVC,aAAa;EACbC,IAAI;EACJC;AACD,CAAC,KACAC,aAAA,CAACpB,IAAI;EAACqB,KAAK,EAAG,CAAEd,MAAM,CAACe,SAAS,EAAEL,aAAa,IAAIV,MAAM,CAACgB,OAAO;AAAI,GACpEH,aAAA,CAACnB,OAAO;EACPW,yBAAyB,EAAGA,yBAA2B;EACvDD,UAAU,EAAGA,UAAY;EACzBK,UAAU,EAAGA,UAAY;EACzBH,MAAM,EAAGA,MAAQ;EACjBC,QAAQ,EAAGA,QAAU;EACrBC,OAAO,EAAGA,OAAS;EACnBE,aAAa,EAAGA,aAAe;EAC/BO,KAAK,EAAGN,IAAM;EACdC,iBAAiB,EAAGA;AAAmB,CACvC,CACI,CACN;AAED,eAAehB,OAAO,CAAE,CACvBE,UAAU,CAAE,CAAEoB,MAAM,EAAE;EAAEC;AAAS,CAAC,KAAM;EACvC,MAAM;IACLC,kBAAkB;IAClBC,wBAAwB;IACxBC,YAAY;IACZC;EACD,CAAC,GAAGL,MAAM,CAAEhB,gBAAiB,CAAC;EAC9B,MAAM;IAAEsB;EAAQ,CAAC,GAAGJ,kBAAkB,CAAED,QAAS,CAAC,IAAI,CAAC,CAAC;EACxD,MAAMM,eAAe,GAAGJ,wBAAwB,CAAC,CAAC,KAAKF,QAAQ;;EAE/D;EACA;EACA;EACA;EACA,MAAMO,QAAQ,GAAGH,oBAAoB,CAAEJ,QAAS,CAAC;EACjD,MAAMQ,eAAe,GAAGL,YAAY,CAAEI,QAAS,CAAC;EAEhD,MAAME,WAAW,GAAG7B,eAAe,CAClC4B,eAAe,EACf,sCAAsC,EACtC,KACD,CAAC;;EAED;EACA;EACA,MAAMjB,aAAa,GAClB,CAAEkB,WAAW,KACX,CAAEjC,QAAQ,CAACkC,OAAO,CAAEL,OAAQ,CAAC,GAAG,CAAC,IAAIC,eAAe,CAAE;EAEzD,OAAO;IACNf,aAAa;IACbC,IAAI,EAAEa;EACP,CAAC;AACF,CAAE,CAAC,EACH3B,YAAY,CAAE,CAAEiC,QAAQ,EAAE;EAAEX;AAAS,CAAC,KAAM;EAC3C,MAAM;IAAEY;EAAsB,CAAC,GAAGD,QAAQ,CAAE5B,gBAAiB,CAAC;EAC9D,OAAO;IACNK,QAAQ,EAAIiB,OAAO,IAAM;MACxBO,qBAAqB,CAAEZ,QAAQ,EAAE;QAAEK;MAAQ,CAAE,CAAC;IAC/C;EACD,CAAC;AACF,CAAE,CAAC,CACF,CAAC,CAAErB,YAAa,CAAC"}